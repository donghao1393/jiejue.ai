<!doctype html><html lang=zh-cn x-data :class=$store.darkMode.class() :data-theme=$store.darkMode.theme()><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>终端里发 API 请求：Shell 变量替换的几种方法 | 爱解决</title><link href=/favicon.ico rel=icon type=image/x-icon><link rel=canonical href=https://jiejue.ai/2026/01/shell-variable-substitution-curl-requests/><meta name=author content="董昊"><meta name=description content="当 Postman 不可用，或者你只是想在终端里快速测试一个 API，curl 是最直接的选择。但当请求里需要动态插入 token、用户名、邮箱这些存在文件里的值时，shell 的引号规则会让人头疼。这篇文章整理了几种在 curl 请求中插入变量的方法，覆盖 Bash 和 Fish 两种常见 shell。
"><meta name=keywords content="Shell,Curl,DevOps,API"><meta name=generator content="Hugo 0.155.2"><meta property="og:url" content="https://jiejue.ai/2026/01/shell-variable-substitution-curl-requests/"><meta property="og:site_name" content="爱解决"><meta property="og:title" content="终端里发 API 请求：Shell 变量替换的几种方法"><meta property="og:description" content="当 Postman 不可用，或者你只是想在终端里快速测试一个 API，curl 是最直接的选择。但当请求里需要动态插入 token、用户名、邮箱这些存在文件里的值时，shell 的引号规则会让人头疼。这篇文章整理了几种在 curl 请求中插入变量的方法，覆盖 Bash 和 Fish 两种常见 shell。"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-13T19:51:20+04:00"><meta property="article:modified_time" content="2026-01-13T19:58:52+04:00"><meta property="article:tag" content="Shell"><meta property="article:tag" content="Curl"><meta property="article:tag" content="DevOps"><meta property="article:tag" content="API"><meta name=twitter:card content="summary"><meta name=twitter:title content="终端里发 API 请求：Shell 变量替换的几种方法"><meta name=twitter:description content="当 Postman 不可用，或者你只是想在终端里快速测试一个 API，curl 是最直接的选择。但当请求里需要动态插入 token、用户名、邮箱这些存在文件里的值时，shell 的引号规则会让人头疼。这篇文章整理了几种在 curl 请求中插入变量的方法，覆盖 Bash 和 Fish 两种常见 shell。"><link rel=stylesheet href=/css/output.min.css><style>pre{padding:1em;overflow:auto}</style><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3.15.1/dist/cdn.min.js integrity="sha256-Rmqrc5SKeSLTSnQ9shSKWmJco1ks8c1hLI8UG2Np03M=" crossorigin=anonymous></script></head><body x-data="{
    flip: false,
  }"><div id=dream-global-bg></div><nav x-data="{ isSticky: false }" x-init="window.addEventListener('scroll', () => { isSticky = window.scrollY > 30 })" class="sticky top-0 z-30 mt-4 lg:mt-8 py-4" :class="{ 'bg-base-100 shadow-lg dark:border-b dark:border-base-content/30': isSticky }"><div class="container flex justify-between px-4"><section class="flex items-center gap-4"><div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title=翻转一下！><div class="h-10 rounded-full"><img src=/favicon.ico alt=爱解决></div></div><div><a href=https://jiejue.ai/ class="text-lg font-semibold cursor-pointer">爱解决</a><div class="text-base-content/60 text-sm">用AI为人民服务</div></div></section><div class="dropdown dropdown-end sm:hidden"><div tabindex=0 role=button class="btn btn-ghost btn-square" aria-label="Select an option"><ion-icon name=menu class=text-2xl></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md"><li><a class="group inline-flex items-center p-2 cursor-pointer" href=/search title=搜索><ion-icon name=search></ion-icon>搜索</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/index.xml title=RSS><ion-icon name=logo-rss></ion-icon>RSS</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/posts title=归档><ion-icon name=archive></ion-icon>归档</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/tags title=所有标签><ion-icon name=pricetags></ion-icon>所有标签</a></li></ul></div><section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/search title=搜索><ion-icon class=group-hover:text-primary-content name=search></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/index.xml title=RSS><ion-icon class=group-hover:text-primary-content name=logo-rss></ion-icon></a><div class="dropdown dropdown-end dropdown-hover"><div tabindex=0 role=button class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" aria-label="Select an option"><ion-icon class="group-hover:text-primary-content text-xl" name=menu></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-xl"><li><a class="inline-flex items-center p-2 cursor-pointer" href=/posts title=归档><ion-icon name=archive></ion-icon>归档</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/tags title=所有标签><ion-icon name=pricetags></ion-icon>所有标签</a></li></ul></div></section></div></nav><div class=flip-container :class="{ 'flip-it': flip }"><div class=flipper><div class=front><div class=container><div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4"><div class="hidden lg:block"></div><div class=lg:col-span-2><article class="mx-auto prose prose-quoteless dark:prose-invert" id=dream-single-post-main itemscope itemtype=http://schema.org/Article><meta itemprop=name content="终端里发 API 请求：Shell 变量替换的几种方法"><meta itemprop=description content="当 Postman 不可用，或者你只是想在终端里快速测试一个 API，curl 是最直接的选择。但当请求里需要动态插入 token、用户名、邮箱这些存在文件里的值时，shell 的引号规则会让人头疼。这篇文章整理了几种在 curl 请求中插入变量的方法，覆盖 Bash 和 Fish 两种常见 shell。"><meta itemprop=datePublished content="2026-01-13T19:51:20+04:00"><meta itemprop=dateModified content="2026-01-13T19:58:52+04:00"><meta itemprop=wordCount content="1443"><meta itemprop=keywords content="Shell,Curl,DevOps,API"><header><h1 itemprop=headline>终端里发 API 请求：Shell 变量替换的几种方法</h1><p class=text-sm><span data-format=luxon>2026-01-13T19:51:20+04:00</span>
| <span>3分钟阅读</span>
| <span>更新于
<span data-format=luxon>2026-01-13T19:58:52+04:00</span></span></p><div class="flex justify-between"><div class="flex items-center"><span>@</span>
<span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=name>董昊</span></span></div><div class="flex items-center gap-2"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://x.com/intent/post?text=%e7%bb%88%e7%ab%af%e9%87%8c%e5%8f%91%20API%20%e8%af%b7%e6%b1%82%ef%bc%9aShell%20%e5%8f%98%e9%87%8f%e6%9b%bf%e6%8d%a2%e7%9a%84%e5%87%a0%e7%a7%8d%e6%96%b9%e6%b3%95&amp;url=https://jiejue.ai/2026/01/shell-variable-substitution-curl-requests/" target=_blank rel="noopener noreferrer" title="Share on X"><ion-icon class=group-hover:text-primary-content name=logo-x></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://facebook.com/sharer/sharer.php?u=https://jiejue.ai/2026/01/shell-variable-substitution-curl-requests/" target=_blank rel="noopener noreferrer" title="Share on Facebook"><ion-icon class=group-hover:text-primary-content name=logo-facebook></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://wa.me/?text=%e7%bb%88%e7%ab%af%e9%87%8c%e5%8f%91%20API%20%e8%af%b7%e6%b1%82%ef%bc%9aShell%20%e5%8f%98%e9%87%8f%e6%9b%bf%e6%8d%a2%e7%9a%84%e5%87%a0%e7%a7%8d%e6%96%b9%e6%b3%95%20https://jiejue.ai/2026/01/shell-variable-substitution-curl-requests/" target=_blank rel="noopener noreferrer" title="Share on WhatsApp"><ion-icon class=group-hover:text-primary-content name=logo-whatsapp></ion-icon></a></div></div></header><section id=dream-single-post-content itemprop=articleBody><figure><img class=z-30 src=https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20260113195417420.webp alt="终端里发 API 请求：Shell 变量替换的几种方法"></figure><p>当 Postman 不可用，或者你只是想在终端里快速测试一个 API，curl 是最直接的选择。但当请求里需要动态插入 token、用户名、邮箱这些存在文件里的值时，shell 的引号规则会让人头疼。这篇文章整理了几种在 curl 请求中插入变量的方法，覆盖 Bash 和 Fish 两种常见 shell。</p><h2 id=问题场景>问题场景</h2><p>假设你有这样一组文件：</p><pre tabindex=0><code>auth.txt        # X-API-Key: sk_live_a1b2c3d4e5f6...
order_id.txt    # ORD-20260113-0042
customer.txt    # customer@example.com
</code></pre><p>你需要用这些值构造一个 PATCH 请求来更新订单信息。</p><h2 id=基础命令替换的引号规则>基础：命令替换的引号规则</h2><p>在 Bash 中，命令替换用 <code>$(...)</code> 语法。关键点是：<strong>双引号内的 <code>$(...)</code> 会被展开，单引号内的不会</strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ✅ 双引号 - 变量会被替换</span>
</span></span><span style=display:flex><span>curl --header <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat auth.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> https://api.example.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ❌ 单引号 - 字面输出 $(cat auth.txt)</span>
</span></span><span style=display:flex><span>curl --header <span style=color:#e6db74>&#39;$(cat auth.txt)&#39;</span> https://api.example.com
</span></span></code></pre></div><p>Fish shell 的语法略有不同，用 <code>(...)</code> 而不是 <code>$(...)</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fish data-lang=fish><span style=display:flex><span><span style=color:#75715e># Fish 语法
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>curl</span> <span style=color:#a6e22e>--header</span> <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> auth.txt<span style=color:#f92672>)</span> https://api.example.com
</span></span></code></pre></div><h2 id=方法一url-中的变量替换>方法一：URL 中的变量替换</h2><p>URL 部分相对简单，用双引号包裹整个 URL 即可：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Bash</span>
</span></span><span style=display:flex><span>curl --location --request GET <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;https://api.example.com/orders/</span><span style=color:#66d9ef>$(</span>cat order_id.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fish data-lang=fish><span style=display:flex><span><span style=color:#75715e># Fish
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>curl</span> <span style=color:#a6e22e>--location</span> <span style=color:#a6e22e>--request</span> GET <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;https://api.example.com/orders/(cat order_id.txt)&#34;</span>
</span></span></code></pre></div><h2 id=方法二header-中的变量替换>方法二：Header 中的变量替换</h2><p>Header 同样在双引号内使用命令替换：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Bash</span>
</span></span><span style=display:flex><span>curl --location --request GET <span style=color:#e6db74>&#34;https://api.example.com/orders&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --header <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat auth.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --header <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fish data-lang=fish><span style=display:flex><span><span style=color:#75715e># Fish - 推荐先存到变量
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> auth <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> auth.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>curl</span> <span style=color:#a6e22e>--location</span> <span style=color:#a6e22e>--request</span> GET <span style=color:#e6db74>&#34;https://api.example.com/orders&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#a6e22e>--header</span> <span style=color:#e6db74>&#34;</span>$auth<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#a6e22e>--header</span> <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span>
</span></span></code></pre></div><h2 id=方法三json-body-中的变量替换>方法三：JSON Body 中的变量替换</h2><p>这是最容易出错的部分。JSON 本身需要双引号包裹字符串值，而 shell 也用双引号来启用变量替换，两者冲突。</p><h3 id=方案-a转义内部双引号繁琐但直接>方案 A：转义内部双引号（繁琐但直接）</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>curl --request PATCH <span style=color:#e6db74>&#34;https://api.example.com/orders/</span><span style=color:#66d9ef>$(</span>cat order_id.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --header <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --header <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat auth.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --data-raw <span style=color:#e6db74>&#34;{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    \&#34;customer\&#34;: \&#34;</span><span style=color:#66d9ef>$(</span>cat customer.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>\&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    \&#34;status\&#34;: \&#34;</span><span style=color:#66d9ef>$(</span>cat status.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>\&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  }&#34;</span>
</span></span></code></pre></div><p>每个 JSON 的双引号都要加反斜杠转义，容易遗漏。</p><h3 id=方案-b用-jq-构建-json推荐>方案 B：用 jq 构建 JSON（推荐）</h3><p>jq 可以安全地构建 JSON，自动处理特殊字符转义：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Bash</span>
</span></span><span style=display:flex><span>jq -n <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --arg customer <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat customer.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --arg address <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat address.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    shipping: {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      recipient: $customer,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      address: $address,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      method: &#34;express&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  }&#39;</span> | curl --request PATCH <span style=color:#e6db74>&#34;https://api.example.com/orders/</span><span style=color:#66d9ef>$(</span>cat order_id.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    --header <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    --header <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat auth.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    -d @-
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fish data-lang=fish><span style=display:flex><span><span style=color:#75715e># Fish
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> customer <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> customer.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> address <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> address.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> auth <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> auth.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> order_id <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> order_id.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> payload <span style=color:#f92672>(</span><span style=color:#a6e22e>jq</span> <span style=color:#a6e22e>-n</span> <span style=color:#a6e22e>--arg</span> customer <span style=color:#e6db74>&#34;</span>$customer<span style=color:#e6db74>&#34;</span> <span style=color:#a6e22e>--arg</span> address <span style=color:#e6db74>&#34;</span>$address<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#39;{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  shipping: {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    recipient: $customer,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    address: $address,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    method: &#34;express&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>curl</span> <span style=color:#a6e22e>--request</span> PATCH <span style=color:#e6db74>&#34;https://api.example.com/orders/</span>$order_id<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#a6e22e>--header</span> <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#a6e22e>--header</span> <span style=color:#e6db74>&#34;</span>$auth<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  <span style=color:#a6e22e>-d</span> <span style=color:#e6db74>&#34;</span>$payload<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>注意 <code>-d @-</code> 表示从 stdin 读取数据，而 <code>--data-raw @-</code> 会把 <code>@-</code> 当作字面字符串。</p><h3 id=jq-中的变量引用>jq 中的变量引用</h3><p>在 jq 内部，用 <code>--arg name value</code> 定义变量后，引用时直接用 <code>$name</code>。如果要在字符串中拼接变量，有两种写法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fish data-lang=fish><span style=display:flex><span><span style=color:#75715e># 字符串拼接
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>jq</span> <span style=color:#a6e22e>-n</span> <span style=color:#a6e22e>--arg</span> id <span style=color:#e6db74>&#34;</span>$order_id<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#39;{tracking: [&#34;TRK-&#34; + $id]}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 字符串插值（反斜杠语法）
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>jq</span> <span style=color:#a6e22e>-n</span> <span style=color:#a6e22e>--arg</span> id <span style=color:#e6db74>&#34;</span>$order_id<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#39;{tracking: [&#34;TRK-\($id)&#34;]}&#39;</span>
</span></span></code></pre></div><p>两者效果相同，但插值语法在复杂模板中更易读。</p><h3 id=方案-cheredoc仅-bash>方案 C：Heredoc（仅 Bash）</h3><p>Bash 支持 heredoc 语法，Fish 不支持：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>curl --request PATCH <span style=color:#e6db74>&#34;https://api.example.com/orders/</span><span style=color:#66d9ef>$(</span>cat order_id.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --header <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --header <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat auth.txt<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  --data-raw <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat <span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;customer&#34;: &#34;$(cat customer.txt)&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;status&#34;: &#34;$(cat status.txt)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><h2 id=方法四用-python-脚本最可靠>方法四：用 Python 脚本（最可靠）</h2><p>当请求复杂度上升，或者需要处理响应、做错误重试时，Python 脚本是最清晰的选择：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_file</span>(path):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(path) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> f<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>order_id <span style=color:#f92672>=</span> read_file(<span style=color:#e6db74>&#39;order_id.txt&#39;</span>)
</span></span><span style=display:flex><span>customer <span style=color:#f92672>=</span> read_file(<span style=color:#e6db74>&#39;customer.txt&#39;</span>)
</span></span><span style=display:flex><span>address <span style=color:#f92672>=</span> read_file(<span style=color:#e6db74>&#39;address.txt&#39;</span>)
</span></span><span style=display:flex><span>api_key <span style=color:#f92672>=</span> read_file(<span style=color:#e6db74>&#39;auth.txt&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;https://api.example.com/orders/</span><span style=color:#e6db74>{</span>order_id<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>headers <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Content-Type&#34;</span>: <span style=color:#e6db74>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;X-API-Key&#34;</span>: api_key<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;X-API-Key: &#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>) <span style=color:#66d9ef>if</span> api_key<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#34;X-API-Key&#34;</span>) <span style=color:#66d9ef>else</span> api_key
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;shipping&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;recipient&#34;</span>: customer,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;address&#34;</span>: address,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;method&#34;</span>: <span style=color:#e6db74>&#34;express&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>patch(url, headers<span style=color:#f92672>=</span>headers, json<span style=color:#f92672>=</span>payload)
</span></span><span style=display:flex><span>print(response<span style=color:#f92672>.</span>status_code)
</span></span><span style=display:flex><span>print(response<span style=color:#f92672>.</span>text)
</span></span></code></pre></div><p>运行方式：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>uv run --with requests python update_order.py
</span></span></code></pre></div><h2 id=附加技巧生成-sql-语句>附加技巧：生成 SQL 语句</h2><p>同样的变量替换思路也适用于生成 SQL。Fish 脚本示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fish data-lang=fish><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env fish
</span></span></span><span style=display:flex><span><span style=color:#75715e># generate_sql.fish
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> old_status <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> old_status.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> new_status <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> new_status.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> order_id <span style=color:#f92672>(</span><span style=color:#a6e22e>cat</span> order_id.txt <span style=color:#f92672>|</span> string trim<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 转义单引号防止 SQL 注入
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>set</span> new_status_escaped <span style=color:#f92672>(</span>string replace <span style=color:#a6e22e>--all</span> <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#e6db74>&#34;&#39;&#39;&#34;</span> <span style=color:#a6e22e>-- </span>$new_status<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;-- Query current status
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SELECT order_id, status FROM orders WHERE order_id = &#39;</span>$order_id<span style=color:#e6db74>&#39;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>-- Update status
</span></span></span><span style=display:flex><span><span style=color:#e6db74>UPDATE orders 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SET status = &#39;</span>$new_status_escaped<span style=color:#e6db74>&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>WHERE order_id = &#39;</span>$order_id<span style=color:#e6db74>&#39;;&#34;</span>
</span></span></code></pre></div><p>运行后重定向到文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-fish data-lang=fish><span style=display:flex><span>fish generate_sql.fish <span style=color:#f92672>&gt;</span> update_order.sql
</span></span></code></pre></div><h2 id=常见陷阱>常见陷阱</h2><p><strong>认证文件格式不一致</strong>：有些 API 要求 header 名和值一起存（如 <code>X-API-Key: sk_xxx</code>），有些只存值。读取时注意格式处理。</p><p><strong>Token 文件重复内容</strong>：如果文件不小心保存了两遍内容（比如复制粘贴时多按了一次），请求会失败。用 <code>wc -c</code> 检查文件大小是否异常。</p><p><strong>文件末尾换行符</strong>：有些工具对换行符敏感。用 <code>string trim</code> (Fish) 或 <code>tr -d '\n'</code> (Bash) 去除。</p><p><strong>单双引号混淆</strong>：记住一条规则——需要变量替换时用双引号，不需要时用单引号。</p><h2 id=选择建议>选择建议</h2><p>根据场景复杂度选择方案：</p><ul><li><strong>简单的一次性请求</strong>：直接在命令行用双引号 + 命令替换</li><li><strong>包含 JSON body</strong>：用 jq 构建，避免手动转义</li><li><strong>需要重复执行或处理响应</strong>：写 Python 脚本</li><li><strong>Fish shell 用户</strong>：先把文件内容存到变量，再构建请求</li></ul><p>掌握这些方法后，在终端里发送 API 请求会变得和 Postman 一样顺手——甚至更快，因为不需要离开键盘。</p></section><div class=divider></div><div class="flex flex-col md:flex-row justify-between gap-4 py-4"><a role=button class="btn btn-outline h-12" href=/2026/01/fd-x-rg-vs-rg-performance-fork-overhead/ title="为什么 fd -x rg 比 rg -t 慢 600 倍？进程 fork 开销的代价"><ion-icon name=chevron-back></ion-icon><div class="inline-flex flex-col items-start"><span class="text-base-content/60 text-xs font-normal">上一页</span>
<span class="max-w-48 truncate">为什么 fd -x rg 比 rg -t 慢 600 倍？进程 fork 开销的代价</span></div></a><a role=button class="btn btn-outline h-12" href=/2026/01/obsidian-internal-links/ title="Obsidian 内部链接完全指南：从基础到块引用"><div class="inline-flex flex-col items-end"><span class="text-base-content/60 text-xs font-normal">下一页</span>
<span class="max-w-48 truncate">Obsidian 内部链接完全指南：从基础到块引用</span></div><ion-icon name=chevron-forward></ion-icon></a></div><div class=divider></div><section class=space-y-4><article><div id=tcomment></div><script src=https://cdn.jsdelivr.net/npm/twikoo@1.6.41/dist/twikoo.min.js></script><script>twikoo.init({envId:"https://6dhzwvtyqz753zhpkrvnnydhlm0vubmy.lambda-url.ap-east-1.on.aws/",el:"#tcomment",region:"ap-east-1",path:"/2026/01/shell-variable-substitution-curl-requests/",lang:"zh-CN"})</script></article></section></article></div><div x-data=tocHighlighter() @scroll.window=debouncedScroll class="hidden lg:flex lg:flex-col lg:items-end"><nav id=TableOfContents><ul><li><a href=#问题场景>问题场景</a></li><li><a href=#基础命令替换的引号规则>基础：命令替换的引号规则</a></li><li><a href=#方法一url-中的变量替换>方法一：URL 中的变量替换</a></li><li><a href=#方法二header-中的变量替换>方法二：Header 中的变量替换</a></li><li><a href=#方法三json-body-中的变量替换>方法三：JSON Body 中的变量替换</a><ul><li><a href=#方案-a转义内部双引号繁琐但直接>方案 A：转义内部双引号（繁琐但直接）</a></li><li><a href=#方案-b用-jq-构建-json推荐>方案 B：用 jq 构建 JSON（推荐）</a></li><li><a href=#jq-中的变量引用>jq 中的变量引用</a></li><li><a href=#方案-cheredoc仅-bash>方案 C：Heredoc（仅 Bash）</a></li></ul></li><li><a href=#方法四用-python-脚本最可靠>方法四：用 Python 脚本（最可靠）</a></li><li><a href=#附加技巧生成-sql-语句>附加技巧：生成 SQL 语句</a></li><li><a href=#常见陷阱>常见陷阱</a></li><li><a href=#选择建议>选择建议</a></li></ul></nav></div></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 - 2026 爱解决</p><p>硅基生物幼稚园</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div><div class=back><div class=container><div class="dream-grid dream-grid-about"></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 - 2026 爱解决</p><p>硅基生物幼稚园</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div></div></div><script>window.lightTheme="emerald",window.darkTheme="forest"</script><script src=https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin=anonymous></script><script src=/js/grid.min.js></script><script src=/js/main.min.js></script><script src=https://cdn.jsdelivr.net/npm/luxon@1.26.0 integrity="sha256-4sbTzmCCW9LGrIh5OsN8V5Pfdad1F1MwhLAOyXKnsE0=" crossorigin=anonymous></script><script>format();function format(){document.querySelectorAll('span[data-format="luxon"]').forEach(e=>{const t=e.textContent;e.textContent=luxon.DateTime.fromISO(t,{locale:"zh"}).toFormat("yyyy年MM月dd日 HH:mm")})}</script><script src=/js/toc.min.js></script><script type=module>
      import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm';
      mediumZoom('#dream-single-post-content img', {
        background: 'oklch(var(--b1))',
        margin: 24,
      })
    </script><script async src="https://www.googletagmanager.com/gtag/js?id=G-S0KCH9BW4F"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S0KCH9BW4F")}</script><script type=module src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin=anonymous></script><script nomodule src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin=anonymous></script></body></html>