<!doctype html><html lang=ru-RU x-data :class=$store.darkMode.class() :data-theme=$store.darkMode.theme()><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright | ЛюбимРешать</title><link href=/favicon.ico rel=icon type=image/x-icon><link rel=canonical href=https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/><meta name=author content="董昊"><meta name=description content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих &ldquo;кирпичных стен&rdquo;, но если я скажу вам, что существует способ напрямую &ldquo;позаимствовать&rdquo; ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?
"><meta name=keywords content="Драматург,Веб-Гусеница,Автоматизация Браузера,Антикроулер,MCP"><meta name=generator content="Hugo 0.148.2"><meta property="og:url" content="https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/"><meta property="og:site_name" content="ЛюбимРешать"><meta property="og:title" content="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><meta property="og:description" content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих “кирпичных стен”, но если я скажу вам, что существует способ напрямую “позаимствовать” ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?"><meta property="og:locale" content="ru_RU"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-05T16:19:16+04:00"><meta property="article:modified_time" content="2025-08-13T18:35:28+04:00"><meta property="article:tag" content="Драматург"><meta property="article:tag" content="Веб-Гусеница"><meta property="article:tag" content="Автоматизация Браузера"><meta property="article:tag" content="Антикроулер"><meta property="article:tag" content="MCP"><meta name=twitter:card content="summary"><meta name=twitter:title content="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><meta name=twitter:description content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих “кирпичных стен”, но если я скажу вам, что существует способ напрямую “позаимствовать” ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?"><link rel=stylesheet href=/css/output.min.css><style>pre{padding:1em;overflow:auto}</style><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin=anonymous></script></head><body x-data="{
    flip: false,
  }"><div id=dream-global-bg></div><nav x-data="{ isSticky: false }" x-init="window.addEventListener('scroll', () => { isSticky = window.scrollY > 30 })" class="sticky top-0 z-30 mt-4 lg:mt-8 py-4" :class="{ 'bg-base-100 shadow-lg dark:border-b dark:border-base-content/30': isSticky }"><div class="container flex justify-between px-4"><section class="flex items-center gap-4"><div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title=Повернуть!><div class="h-10 rounded-full"><img src=/favicon.ico alt=爱解决></div></div><div><a href=/ru class="text-lg font-semibold cursor-pointer">爱解决</a><div class="text-base-content/60 text-sm">用AI为人民服务</div></div></section><div class="dropdown dropdown-end sm:hidden"><div tabindex=0 role=button class="btn btn-ghost btn-square" aria-label="Select an option"><ion-icon name=menu class=text-2xl></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md"><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/index.xml title=RSS><ion-icon name=logo-rss></ion-icon>RSS</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/posts title=Архивы><ion-icon name=archive></ion-icon>Архивы</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/tags title="Все теги"><ion-icon name=pricetags></ion-icon>Все теги</a></li></ul></div><section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/ru/index.xml title=RSS><ion-icon class=group-hover:text-primary-content name=logo-rss></ion-icon></a><div class="dropdown dropdown-end dropdown-hover"><div tabindex=0 role=button class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" aria-label="Select an option"><ion-icon class="group-hover:text-primary-content text-xl" name=menu></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-xl"><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/posts title=Архивы><ion-icon name=archive></ion-icon>Архивы</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/tags title="Все теги"><ion-icon name=pricetags></ion-icon>Все теги</a></li></ul></div><div class="dropdown dropdown-end dropdown-hover language-switcher"><div tabindex=0 role=button class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" title="Переключить язык"><ion-icon class=group-hover:text-primary-content name=language-outline></ion-icon><span class="ml-1 hidden md:inline group-hover:text-primary-content language-name">Русский</span></div><ul tabindex=0 class="dropdown-content menu bg-base-100 rounded-box z-[1] shadow-xl border border-base-content/20" style=min-width:6rem;width:auto><li><a href=/zh/2025/07/playwright-bypass-login-crawler/ class="flex items-center gap-2"><span class="flag flag-cn"></span>
<span class=language-name>中文</span></a></li></ul></div></section></div></nav><div class=flip-container :class="{ 'flip-it': flip }"><div class=flipper><div class=front><div class=container><div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4"><div class="hidden lg:block"></div><div class=lg:col-span-2><article class="mx-auto prose prose-quoteless dark:prose-invert" id=dream-single-post-main itemscope itemtype=http://schema.org/Article><meta itemprop=name content="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><meta itemprop=description content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих “кирпичных стен”, но если я скажу вам, что существует способ напрямую “позаимствовать” ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?"><meta itemprop=datePublished content="2025-07-05T16:19:16+04:00"><meta itemprop=dateModified content="2025-08-13T18:35:28+04:00"><meta itemprop=wordCount content="9091"><meta itemprop=keywords content="Драматург,Веб-Гусеница,Автоматизация Браузера,Антикроулер,MCP"><header><h1 itemprop=headline>Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright</h1><p class=text-sm><span data-format=luxon>2025-07-05T16:19:16+04:00</span>
| <span>19 минут чтения</span>
| <span>Обновлено
<span data-format=luxon>2025-08-13T18:35:28+04:00</span></span></p><div class="flex justify-between"><div class="flex items-center"><span>@</span>
<span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=name>董昊</span></span></div><div class="flex items-center gap-2"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://x.com/intent/post?text=%d0%a0%d0%b0%d0%b7%d1%80%d1%83%d1%88%d0%b0%d1%8f%20%d0%b3%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%8b%20%d1%82%d1%80%d0%b0%d0%b4%d0%b8%d1%86%d0%b8%d0%be%d0%bd%d0%bd%d1%8b%d1%85%20%d0%ba%d1%80%d0%b0%d1%83%d0%bb%d0%b5%d1%80%d0%be%d0%b2:%20%d0%ba%d0%be%d0%bc%d0%bf%d0%bb%d0%b5%d0%ba%d1%81%d0%bd%d0%be%d0%b5%20%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%bb%d1%8f%20%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%b1%d1%80%d0%b0%d1%83%d0%b7%d0%b5%d1%80%d0%b0%20%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f%20%d0%ba%20%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b5%20%d0%b2%d1%85%d0%be%d0%b4%d0%b0%20%d0%b2%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d1%81%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e%20Playwright&amp;url=https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/" target=_blank rel="noopener noreferrer" title="Share on X"><ion-icon class=group-hover:text-primary-content name=logo-x></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://facebook.com/sharer/sharer.php?u=https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/" target=_blank rel="noopener noreferrer" title="Share on Facebook"><ion-icon class=group-hover:text-primary-content name=logo-facebook></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://wa.me/?text=%d0%a0%d0%b0%d0%b7%d1%80%d1%83%d1%88%d0%b0%d1%8f%20%d0%b3%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%8b%20%d1%82%d1%80%d0%b0%d0%b4%d0%b8%d1%86%d0%b8%d0%be%d0%bd%d0%bd%d1%8b%d1%85%20%d0%ba%d1%80%d0%b0%d1%83%d0%bb%d0%b5%d1%80%d0%be%d0%b2:%20%d0%ba%d0%be%d0%bc%d0%bf%d0%bb%d0%b5%d0%ba%d1%81%d0%bd%d0%be%d0%b5%20%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%bb%d1%8f%20%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%b1%d1%80%d0%b0%d1%83%d0%b7%d0%b5%d1%80%d0%b0%20%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f%20%d0%ba%20%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b5%20%d0%b2%d1%85%d0%be%d0%b4%d0%b0%20%d0%b2%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d1%81%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e%20Playwright%20https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/" target=_blank rel="noopener noreferrer" title="Share on WhatsApp"><ion-icon class=group-hover:text-primary-content name=logo-whatsapp></ion-icon></a></div></div></header><section id=dream-single-post-content itemprop=articleBody><img class="w-full z-30" src=https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250705162011982.webp alt="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><p>Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих &ldquo;кирпичных стен&rdquo;, но если я скажу вам, что существует способ напрямую &ldquo;позаимствовать&rdquo; ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?</p><h2 id=传统爬虫的困境>传统爬虫的困境</h2><p>Как разработчик, вы наверняка сталкивались с этой головной болью:</p><ul><li><strong>Сложная проверка логина</strong>: CAPTCHA, SMS-верификация, человеко-машинная верификация - бесконечное множество вариантов.</li><li><strong>Строгое обнаружение антикраулеров</strong>: обнаружение User-Agent, ограничение частоты, блокировка IP-адресов.</li><li><strong>Сложность управления сессиями</strong>: истечение срока действия куки, обновление токенов, многоступенчатая аутентификация</li><li><strong>Приватное содержимое недоступно</strong>: личная домашняя страница, личные сообщения, управление фоном и другие страницы, требующие разрешений.</li></ul><p>Проблема Сяо Ли в электронной коммерции: ему приходится каждый день проверять данные о магазине на нескольких платформах, вручную входить в систему, проверять и записывать, тратя массу времени на повторяющийся труд. А при написании краулера приходится заниматься всевозможными проверками, что требует больших затрат.</p><h2 id=playwright的革命性方案>Playwright的革命性方案</h2><p>Playwright предлагает гениальное решение: <strong>подключение к существующему экземпляру браузера пользователя</strong>. Это как &ldquo;прикрепление&rdquo; к браузеру и прямое использование статуса входа, файлов cookie и даже расширений браузера.</p><h3 id=核心原理chrome-devtools-protocol-cdp>核心原理：Chrome DevTools Protocol (CDP)</h3><p>Современные браузеры поддерживают протокол CDP, который изначально создавался как инструмент разработчика, но мы можем &ldquo;позаимствовать&rdquo; его для реализации программного управления браузером.</p><pre class=mermaid>
  graph LR
    A[用户浏览器] --&gt;|CDP端口9222| B[Playwright脚本]
    B --&gt; C[读取页面内容]
    B --&gt; D[执行用户操作]
    B --&gt; E[获取登录状态]
    
    A --&gt; F[保留所有设置]
    F --&gt; G[Cookie]
    F --&gt; H[登录状态]
    F --&gt; I[浏览器扩展]
</pre><h2 id=实战演示从零到一的完整实现>实战演示：从零到一的完整实现</h2><h3 id=第一步启动调试模式的浏览器>第一步：启动调试模式的浏览器</h3><p>Это ключевой первый шаг во всей программе. Вы должны разрешить браузеру открыть &ldquo;черный ход&rdquo;, чтобы позволить внешним программам подключаться.</p><p><strong>在macOS上：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/Applications/Google<span style=color:#ae81ff>\ </span>Chrome.app/Contents/MacOS/Google<span style=color:#ae81ff>\ </span>Chrome --remote-debugging-port<span style=color:#f92672>=</span><span style=color:#ae81ff>9222</span>
</span></span></code></pre></div><p><strong>在Windows上：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>chrome.exe --remote-debugging-port=9222
</span></span></code></pre></div><p><strong>在Linux上：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>google-chrome --remote-debugging-port<span style=color:#f92672>=</span><span style=color:#ae81ff>9222</span>
</span></span></code></pre></div><p>当你看到这样的输出时，就说明成功了：</p><pre tabindex=0><code>DevTools listening on ws://127.0.0.1:9222/devtools/browser/8d2806ff-58c5-43b7-b9f4-eadfdbfe87cf
</code></pre><h3 id=第二步验证连接>第二步：验证连接</h3><p>Зайдите на <code>http://localhost:9222/json/version</code> в браузере, и если вы увидите ответ в формате JSON, значит, отладочный порт открыт.</p><h3 id=第三步编写连接脚本>第三步：编写连接脚本</h3><p>Здесь представлены две версии реализации:</p><h4 id=javascript版本推荐新手>JavaScript版本（推荐新手）</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>chromium</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;playwright&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span><span style=color:#f92672>-</span><span style=color:#a6e22e>функция</span> <span style=color:#a6e22e>connectToUserBrowser</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Подключение к браузеру...&#39;</span>) ;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Подключение к экземпляру браузера пользователя
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>browser</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>chromium</span>.<span style=color:#a6e22e>connectOverCDP</span>(<span style=color:#e6db74>&#39;http://localhost:9222&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Подключение успешно!&#39;</span>) ;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Получаем существующий контекст браузера (со всеми состояниями входа)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>context</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>browser</span>.<span style=color:#a6e22e>contexts</span>()[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Получение текущей или создание новой страницы
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>page</span>; <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pages</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>pages</span>(); <span style=color:#75715e>// Получение текущей страницы или создание новой.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pages</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>pages</span>(); <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pages</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pages</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>page</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pages</span>[<span style=color:#ae81ff>0</span>]; <span style=color:#75715e>// используем существующую страницу
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`текущая страница: </span><span style=color:#e6db74>${</span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>title</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>); } <span style=color:#66d9ef>else</span> { <span style=color:#a6e22e>page</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>page</span>[<span style=color:#ae81ff>0</span>]; <span style=color:#75715e>// использовать существующую страницу.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>page</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>newPage</span>(); <span style=color:#75715e>// создаем новую страницу
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Пример: доступ к странице Taobao, требующей логина
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#66d9ef>goto</span>(<span style=color:#e6db74>&#39;https://www.taobao.com&#39;</span>); <span style=color:#75715e>// Создаем новую страницу.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Проверяем статус входа
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isLoggedIn</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>locator</span>(<span style=color:#e6db74>&#39;.site-nav-user&#39;</span>).<span style=color:#a6e22e>isVisible</span>(); <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isLoggedIn</span>) { <span style=color:#75715e>// проверка статуса входа в систему; // проверка статуса входа в систему.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isLoggedIn</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Вход на Taobao обнаружен!) ;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            // Получение информации о пользователе
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            const username = await page.locator(&#39;</span>.<span style=color:#a6e22e>site</span><span style=color:#f92672>-</span><span style=color:#a6e22e>nav</span><span style=color:#f92672>-</span><span style=color:#a6e22e>user</span><span style=color:#e6db74>&#39;).textContent();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            console.log(`Имя пользователя: ${username}`);;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            // Теперь вы можете получить доступ к своему персональному центру, странице заказа и т.д.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            await page.goto(&#39;</span><span style=color:#a6e22e>https</span><span style=color:#f92672>:</span><span style=color:#75715e>//trade.taobao.com/trade/itemlist/list_bought_items.htm&#39;); // Теперь вы можете получить доступ к своему персональному центру, странице заказа и т. д.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Успешный доступ к странице заказов!&#39;</span>) ;)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Не удалось установить соединение:&#39;</span>, <span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span>); } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) { <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Убедитесь, что ваш браузер получил доступ к странице заказов!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        console.log(&#39;</span><span style=color:#a6e22e>Убедитесь</span>, <span style=color:#a6e22e>что</span> <span style=color:#a6e22e>в</span> <span style=color:#a6e22e>вашем</span> <span style=color:#a6e22e>браузере</span> <span style=color:#a6e22e>включен</span> <span style=color:#a6e22e>режим</span> <span style=color:#a6e22e>отладки</span><span style=color:#960050;background-color:#1e0010>&#39;</span>); }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connectToUserBrowser</span>();
</span></span></code></pre></div><h4 id=python版本适合数据分析师>Python版本（适合数据分析师）</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> asyncio
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> playwright.async_api <span style=color:#f92672>import</span> async_playwright
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>connect_to_user_browser</span>()<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;Подключение к вашему браузеру...&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>async</span> с async_playwright() <span style=color:#66d9ef>as</span> p<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span><span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Подключение к браузеру пользователя</span>
</span></span><span style=display:flex><span>            browser <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> p<span style=color:#f92672>.</span>chromium<span style=color:#f92672>.</span>connect_over_cdp(<span style=color:#e6db74>&#39;http://localhost:9222&#39;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#39;Соединение успешно!&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Получение существующих контекстов</span>
</span></span><span style=display:flex><span>            context <span style=color:#f92672>=</span> browser<span style=color:#f92672>.</span>contexts[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Создание новой страницы</span>
</span></span><span style=display:flex><span>            page <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> context<span style=color:#f92672>.</span>new_page()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Доступ к микроблогу</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> page<span style=color:#f92672>.</span>goto(<span style=color:#e6db74>&#39;https://weibo.com&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># Проверка статуса входа в систему</span>
</span></span><span style=display:flex><span>            login_element <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> page<span style=color:#f92672>.</span>query_selector(<span style=color:#e6db74>&#39;.login&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> login_element<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#39;Вход в твиттер обнаружен!&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># Получение данных микроблога</span>
</span></span><span style=display:flex><span>                posts <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> page<span style=color:#f92672>.</span>query_selector_all(<span style=color:#e6db74>&#39;.card-wrap&#39;</span>)
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Fetched </span><span style=color:#e6db74>{</span>len(posts)<span style=color:#e6db74>}</span><span style=color:#e6db74> tweets&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e># Обработка каждого твита</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> i, post <span style=color:#f92672>in</span> enumerate(posts[:<span style=color:#ae81ff>5</span>]): <span style=color:#75715e># обрабатываем только первые 5 сообщений</span>
</span></span><span style=display:flex><span>                    text <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> post<span style=color:#f92672>.</span>inner_text()
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;tweet </span><span style=color:#e6db74>{</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>text[:<span style=color:#ae81ff>50</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>...&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> error: print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Twitter </span><span style=color:#e6db74>{</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>text[:<span style=color:#ae81ff>50</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>...&#39;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Connection failed: </span><span style=color:#e6db74>{</span>error<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 运行</span>
</span></span><span style=display:flex><span>asyncio<span style=color:#f92672>.</span>run(connect_to_user_browser())
</span></span></code></pre></div><h2 id=实际测试数据真实案例验证>实际测试数据：真实案例验证</h2><p>В ходе реального тестирования я использовал это решение для успешного подключения к браузеру Vivaldi, содержащему 89 вкладок, и получил следующие результаты:</p><h3 id=成功访问的私人内容>成功访问的私人内容：</h3><ol><li><p><strong>Личное пространство на сайте B</strong></p><ul><li>Количество поклонников: 265</li><li>Просмотров: 348 000</li><li>Последние видеоматериалы</li><li>Личная статистика</li></ul></li><li><p><strong>Личная временная шкала Twitter</strong>.</p><ul><li>Домашняя страница личного аккаунта</li><li>Приватный рекомендуемый контент</li><li>Сообщения уведомлений</li></ul></li><li><p><strong>Администрирование бэкенда WordPress</strong></p><ul><li>Полный интерфейс администратора</li><li>Доступ к редактированию статей</li><li>Доступ к настройке сайта</li></ul></li><li><p><strong>Приватный диалог Claude.ai</strong></p><ul><li>Техническое обсуждение, содержащее 288 блоков кода</li><li>Приватный обмен связанным контентом</li><li>Полная история диалога</li></ul></li></ol><h3 id=性能数据>性能数据：</h3><ul><li><strong>Скорость подключения</strong>: &lt; 2 секунд</li><li><strong>Загрузка страниц</strong>: такая же, как в обычном браузере</li><li><strong>Стабильность</strong>: работает непрерывно в течение нескольких часов</li><li><strong>Совместимость</strong>: поддерживает Chrome, Edge, Vivaldi и другие браузеры на ядре Chromium.</li></ul><h2 id=通过mcp增强ai能力>通过MCP增强AI能力</h2><p>Если вы используете ИИ-помощника, например Claude, вы также можете позволить ему управлять браузером напрямую через MCP (Model Context Protocol). Это революционная функция, которая позволяет ИИ фактически &ldquo;видеть&rdquo; и &ldquo;манипулировать&rdquo; веб-страницами.</p><h3 id=一键配置mcp>一键配置MCP</h3><p>Для использования клиентов AI с поддержкой MCP, таких как Claude Desktop, Cline и т. д., вам просто нужно добавить следующую конфигурацию JSON в файл конфигурации:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;mcpServers&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Playwright&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;npx&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;args&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;-y&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;@playwright/mcp@latest&#34;</span>
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>После настройки ИИ сможет напрямую вызывать функцию Playwright:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// AI可以直接执行这些操作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>Playwright</span>.<span style=color:#a6e22e>browser_navigate</span>(<span style=color:#e6db74>&#34;https://example.com&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>Playwright</span>.<span style=color:#a6e22e>browser_type</span>(<span style=color:#e6db74>&#34;搜索框选择器&#34;</span>, <span style=color:#e6db74>&#34;搜索内容&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>Playwright</span>.<span style=color:#a6e22e>browser_click</span>(<span style=color:#e6db74>&#34;提交按钮选择器&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>Playwright</span>.<span style=color:#a6e22e>browser_take_screenshot</span>();
</span></span></code></pre></div><h3 id=mcp的独特优势>MCP的独特优势</h3><p>По сравнению с традиционными методами программирования, возможность ИИ управлять браузером через MCP имеет следующие преимущества:</p><ol><li><strong>Управление на естественном языке</strong>: Вы можете напрямую сказать ИИ &ldquo;Помогите мне войти на Taobao и проверить последние заказы&rdquo;.</li><li><strong>Интеллектуальная адаптация</strong>: ИИ может автоматически корректировать стратегию работы в соответствии со структурой страницы.</li><li><strong>Обработка ошибок</strong>: ИИ может автоматически повторять попытки и обрабатывать исключения.</li><li><strong>Мгновенная обратная связь</strong>: ИИ может анализировать содержимое страницы и принимать решения в режиме реального времени.</li></ol><p>Это позволяет ИИ манипулировать веб-страницами и выполнять сложные автоматизированные задачи так же, как люди.</p><h2 id=应用场景解决实际问题>应用场景：解决实际问题</h2><h3 id=1-电商运营自动化>1. 电商运营自动化</h3><p><strong>Сценарий</strong>: Сяо Ван управляет магазинами на 10 различных платформах и должен ежедневно проверять заказы, отвечать на запросы клиентов и обновлять товары.</p><p><strong>解决方案</strong>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 自动检查各平台订单
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>platforms</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;taobao&#39;</span>, <span style=color:#e6db74>&#39;jd&#39;</span>, <span style=color:#e6db74>&#39;pinduoduo&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>platform</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>platforms</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>checkOrders</span>(<span style=color:#a6e22e>platform</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>replyMessages</span>(<span style=color:#a6e22e>platform</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>updateInventory</span>(<span style=color:#a6e22e>platform</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-社交媒体管理>2. 社交媒体管理</h3><p><strong>Сценарий</strong>: Создателям контента необходимо одновременно публиковать материалы на Weibo, Xiaohongshu, Jieyin и других платформах.</p><p><strong>解决方案</strong>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 批量发布内容
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>content</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;今天分享一个实用技巧...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>images</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;image1.jpg&#34;</span>, <span style=color:#e6db74>&#34;image2.jpg&#34;</span>]
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>publishToWeibo</span>(<span style=color:#a6e22e>content</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>publishToXiaohongshu</span>(<span style=color:#a6e22e>content</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>publishToDouyin</span>(<span style=color:#a6e22e>content</span>);
</span></span></code></pre></div><h3 id=3-企业内部系统自动化>3. 企业内部系统自动化</h3><p><strong>Сценарий</strong>: отделу кадров необходимо еженедельно обновлять информацию о сотрудниках и формировать отчеты в нескольких системах.</p><p><strong>解决方案</strong>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 自动化HR流程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>updateEmployeeInfo</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>generateWeeklyReport</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>submitToApprovalSystem</span>();
</span></span></code></pre></div><h2 id=安全性和合规性考虑>安全性和合规性考虑</h2><h3 id=安全措施>安全措施</h3><ol><li><strong>Локальная работа</strong>: все операции выполняются локально, утечка данных исключена</li><li><strong>Авторизация пользователя</strong>: требуется, чтобы пользователь активно открыл порт отладки.</li><li><strong>Прозрачность и управляемость</strong>: пользователи могут просматривать и останавливать работу скрипта в любое время.</li><li><strong>Наследование привилегий</strong>: использование существующих привилегий пользователя, не превышающих права доступа</li></ol><h3 id=合规建议>合规建议</h3><ol><li><strong>Уважение к условиям использования веб-сайта</strong>: обеспечение соответствия автоматического поведения условиям использования веб-сайта</li><li><strong>Контроль частоты</strong>: избегайте слишком частых запросов.</li><li><strong>Защита данных</strong>: надлежащим образом обрабатывайте полученные данные, чтобы защитить вашу конфиденциальность.</li><li><strong>Коммерческое использование</strong>: перед коммерческим использованием ознакомьтесь с соответствующими юридическими условиями.</li></ol><h2 id=常见问题解答>常见问题解答</h2><h3 id=q-这种方法相比传统爬虫有什么优势>Q: 这种方法相比传统爬虫有什么优势？</h3><p>О: Основные преимущества включают:</p><ul><li><strong>Нет входа</strong>: напрямую используйте существующий статус входа.</li><li><strong>Антиобнаружение</strong>: использование реальной среды браузера, нелегко быть распознанным</li><li><strong>Полная функциональность</strong>: поддерживает JavaScript, Cookies, Session и т.д.</li><li><strong>Поддержка плагинов</strong>: можно использовать преимущества расширений браузера, таких как блокировщики рекламы</li></ul><h3 id=q-会不会影响正常使用浏览器>Q: 会不会影响正常使用浏览器？</h3><p>О: Нет. Скрипт просто &ldquo;прикрепляется&rdquo; к браузеру, и вы можете продолжать просматривать веб-страницы в обычном режиме. Новые вкладки, созданные скриптом, будут четко обозначены.</p><h3 id=q-支持哪些浏览器>Q: 支持哪些浏览器？</h3><p>О: Поддерживаются все браузеры на базе Chromium:</p><ul><li>Google Chrome</li><li>Microsoft Edge</li><li>Вивальди</li><li>Вивальди</li><li>Opera
и т.д.</li></ul><h3 id=q-如何处理页面动态内容>Q: 如何处理页面动态内容？</h3><p>A: Playwright内置了强大的等待机制：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 等待元素出现
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForSelector</span>(<span style=color:#e6db74>&#39;.dynamic-content&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Дождитесь завершения сетевого запроса
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForLoadState</span>(<span style=color:#e6db74>&#39;networkidle&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 等待特定条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForFunction</span>(() =&gt; window.<span style=color:#a6e22e>dataLoaded</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>true</span>);
</span></span></code></pre></div><h3 id=q-mcp配置文件在哪里>Q: MCP配置文件在哪里？</h3><p>A: Расположение файлов конфигурации для разных клиентов:</p><p><strong>Клод Десктоп:</strong>.</p><ul><li>macOS: <code>~/Library/Application Support/Claude/claude_desktop_config.json</code>.</li><li>Windows: <code>%APPDATA%\Claude\claude_desktop_config.json</code></li></ul><p><strong>Cline (плагин для VS Code):</strong>.</p><ul><li>Откройте Settings в VS Code и найдите &ldquo;Cline: MCP&rdquo;.</li><li>или просто отредактируйте <code>.vscode/settings.json</code> в рабочем пространстве</li></ul><p>Просто добавьте конфигурацию JSON в соответствующий файл.</p><h2 id=进阶技巧>进阶技巧</h2><h3 id=1-批量处理多个账号>1. 批量处理多个账号</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 使用不同的用户数据目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>contexts</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>9222</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;账号1&#39;</span> },
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>9223</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;账号2&#39;</span> },
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>9224</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;账号3&#39;</span> }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ctx</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>contexts</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>browser</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>chromium</span>.<span style=color:#a6e22e>connectOverCDP</span>(<span style=color:#e6db74>`http://localhost:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>port</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>processAccount</span>(<span style=color:#a6e22e>browser</span>, <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>name</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-错误处理和重试机制>2. 错误处理和重试机制</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>robustOperation</span>(<span style=color:#a6e22e>page</span>, <span style=color:#a6e22e>operation</span>, <span style=color:#a6e22e>maxRetries</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>maxRetries</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>operation</span>(<span style=color:#a6e22e>page</span>);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`尝试 </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> 失败：</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>maxRetries</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForTimeout</span>(<span style=color:#ae81ff>1000</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)); <span style=color:#75715e>// 递增延迟
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=3-数据持久化>3. 数据持久化</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存浏览器状态供下次使用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>storageState</span>({ <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;user-session.json&#39;</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 下次直接加载状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>context</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>browser</span>.<span style=color:#a6e22e>newContext</span>({ 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>storageState</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;user-session.json&#39;</span> 
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=总结>总结</h2><p>Благодаря тому, что Playwright подключается к браузеру пользователя, мы успешно преодолели ограничения традиционных краулеров:</p><ol><li><strong>Нулевой порог входа</strong>: нет необходимости разбираться со сложными процессами аутентификации</li><li><strong>Имитация реальной среды</strong>: использование реальных отпечатков пальцев и настроек браузера</li><li><strong>Доступ к частному содержимому</strong>: получение данных о странице, требующей разрешения.</li><li><strong>Высокая степень автоматизации</strong>: в сочетании с искусственным интеллектом для достижения интеллектуальной работы</li></ol><p>Это решение особенно подходит для индивидуальных разработчиков и небольших команд, помогая им быстро реализовать свои потребности в веб-автоматизации. Независимо от того, занимаетесь ли вы электронной коммерцией, создаете контент или являетесь ИТ-администратором предприятия, вы сможете найти в нем подходящий сценарий применения.</p><p>Помните, что технология нейтральна; все дело в том, насколько ответственно она используется. Наслаждаясь удобством автоматизации, важно соблюдать условия использования веб-сайтов и конфиденциальность пользователей.</p><h2 id=快速开始清单>快速开始清单</h2><p>Для читателей, которым не терпится опробовать его, вот список для быстрого старта:</p><h3 id=基础版编程控制>基础版（编程控制）</h3><ol><li>☑️ 启动调试模式浏览器</li><li>☑️ 安装Playwright：<code>npm install playwright</code></li><li>☑️ 复制文章中的代码示例</li><li>☑️ 运行第一个测试脚本</li></ol><h3 id=mcp版ai控制>MCP版（AI控制）</h3><ol><li>☑️ 在AI客户端配置文件中添加MCP配置</li><li>☑️ 重启AI客户端</li><li>☑️ 直接告诉AI：“请访问淘宝并截图”</li></ol><p>Начните свой путь к автоматизации прямо сейчас! Начните с простого посещения страницы и шаг за шагом создавайте своего веб-помощника.</p></section><div class=divider></div><div class="flex flex-col md:flex-row justify-between gap-4 py-4"><a role=button class="btn btn-outline h-12" href=/ru/2025/07/kubernetes-annotations-string-type-constraint/ title="Ограничения типов строк для аннотаций Kubernetes: от ошибок к пониманию"><ion-icon name=chevron-back></ion-icon><div class="inline-flex flex-col items-start"><span class="text-base-content/60 text-xs font-normal">Предыдущая</span>
<span class="max-w-48 truncate">Ограничения типов строк для аннотаций Kubernetes: от ошибок к пониманию</span></div></a><a role=button class="btn btn-outline h-12" href=/ru/2025/07/mac-ai-frameworks-comparison/ title="Великая развилка разработки ИИ на платформе Mac: экологическая битва между MPS, MLX и PyTorch"><div class="inline-flex flex-col items-end"><span class="text-base-content/60 text-xs font-normal">Следующая</span>
<span class="max-w-48 truncate">Великая развилка разработки ИИ на платформе Mac: экологическая битва между MPS, MLX и PyTorch</span></div><ion-icon name=chevron-forward></ion-icon></a></div><div class=divider></div><section class=space-y-4><article><div id=tcomment></div><script src=https://cdn.jsdelivr.net/npm/twikoo@1.6.41/dist/twikoo.min.js></script><script>twikoo.init({envId:"https://6dhzwvtyqz753zhpkrvnnydhlm0vubmy.lambda-url.ap-east-1.on.aws/",el:"#tcomment",region:"ap-east-1",path:"/ru/2025/07/playwright-bypass-login-crawler/",lang:"zh-CN"})</script></article></section></article></div><div x-data=tocHighlighter() @scroll.window=debouncedScroll class="hidden lg:flex lg:flex-col lg:items-end"><nav id=TableOfContents><ul><li><a href=#传统爬虫的困境>传统爬虫的困境</a></li><li><a href=#playwright的革命性方案>Playwright的革命性方案</a><ul><li><a href=#核心原理chrome-devtools-protocol-cdp>核心原理：Chrome DevTools Protocol (CDP)</a></li></ul></li><li><a href=#实战演示从零到一的完整实现>实战演示：从零到一的完整实现</a><ul><li><a href=#第一步启动调试模式的浏览器>第一步：启动调试模式的浏览器</a></li><li><a href=#第二步验证连接>第二步：验证连接</a></li><li><a href=#第三步编写连接脚本>第三步：编写连接脚本</a></li></ul></li><li><a href=#实际测试数据真实案例验证>实际测试数据：真实案例验证</a><ul><li><a href=#成功访问的私人内容>成功访问的私人内容：</a></li><li><a href=#性能数据>性能数据：</a></li></ul></li><li><a href=#通过mcp增强ai能力>通过MCP增强AI能力</a><ul><li><a href=#一键配置mcp>一键配置MCP</a></li><li><a href=#mcp的独特优势>MCP的独特优势</a></li></ul></li><li><a href=#应用场景解决实际问题>应用场景：解决实际问题</a><ul><li><a href=#1-电商运营自动化>1. 电商运营自动化</a></li><li><a href=#2-社交媒体管理>2. 社交媒体管理</a></li><li><a href=#3-企业内部系统自动化>3. 企业内部系统自动化</a></li></ul></li><li><a href=#安全性和合规性考虑>安全性和合规性考虑</a><ul><li><a href=#安全措施>安全措施</a></li><li><a href=#合规建议>合规建议</a></li></ul></li><li><a href=#常见问题解答>常见问题解答</a><ul><li><a href=#q-这种方法相比传统爬虫有什么优势>Q: 这种方法相比传统爬虫有什么优势？</a></li><li><a href=#q-会不会影响正常使用浏览器>Q: 会不会影响正常使用浏览器？</a></li><li><a href=#q-支持哪些浏览器>Q: 支持哪些浏览器？</a></li><li><a href=#q-如何处理页面动态内容>Q: 如何处理页面动态内容？</a></li><li><a href=#q-mcp配置文件在哪里>Q: MCP配置文件在哪里？</a></li></ul></li><li><a href=#进阶技巧>进阶技巧</a><ul><li><a href=#1-批量处理多个账号>1. 批量处理多个账号</a></li><li><a href=#2-错误处理和重试机制>2. 错误处理和重试机制</a></li><li><a href=#3-数据持久化>3. 数据持久化</a></li></ul></li><li><a href=#总结>总结</a></li><li><a href=#快速开始清单>快速开始清单</a><ul><li><a href=#基础版编程控制>基础版（编程控制）</a></li><li><a href=#mcp版ai控制>MCP版（AI控制）</a></li></ul></li></ul></nav></div></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 ЛюбимРешать</p><p>一个热爱解决问题的网站</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div><div class=back><div class=container><div class="dream-grid dream-grid-about"></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 ЛюбимРешать</p><p>一个热爱解决问题的网站</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div></div></div><script>window.lightTheme="emerald",window.darkTheme="forest"</script><script src=https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin=anonymous></script><script src=/js/grid.min.js></script><script src=/js/main.min.js></script><script src=https://cdn.jsdelivr.net/npm/luxon@1.26.0 integrity="sha256-4sbTzmCCW9LGrIh5OsN8V5Pfdad1F1MwhLAOyXKnsE0=" crossorigin=anonymous></script><script>format();function format(){document.querySelectorAll('span[data-format="luxon"]').forEach(e=>{const t=e.textContent;e.textContent=luxon.DateTime.fromISO(t,{locale:"ru"}).toFormat("yyyy年MM月dd日 HH:mm")})}</script><script src=/js/toc.min.js></script><script type=module>
      import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm';
      mediumZoom('#dream-single-post-content img', {
        background: 'oklch(var(--b1))',
        margin: 24,
      })
    </script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
      </script><script async src="https://www.googletagmanager.com/gtag/js?id=G-S0KCH9BW4F"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S0KCH9BW4F")}</script><script type=module src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin=anonymous></script><script nomodule src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin=anonymous></script></body></html>