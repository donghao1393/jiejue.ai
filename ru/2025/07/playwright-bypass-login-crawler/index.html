<!doctype html><html lang=ru-RU x-data :class=$store.darkMode.class() :data-theme=$store.darkMode.theme()><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright | ЛюбимРешать</title><link href=/favicon.ico rel=icon type=image/x-icon><link rel=canonical href=https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/><meta name=author content="董昊"><meta name=description content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих &ldquo;кирпичных стен&rdquo;, но если я скажу вам, что существует способ напрямую &ldquo;позаимствовать&rdquo; ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?
"><meta name=keywords content="Драматург,Веб-Гусеница,Автоматизация Браузера,Антикроулер,MCP"><meta name=generator content="Hugo 0.148.2"><meta property="og:url" content="https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/"><meta property="og:site_name" content="ЛюбимРешать"><meta property="og:title" content="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><meta property="og:description" content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих “кирпичных стен”, но если я скажу вам, что существует способ напрямую “позаимствовать” ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?"><meta property="og:locale" content="ru_RU"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-05T16:19:16+04:00"><meta property="article:modified_time" content="2025-08-13T15:03:02+00:00"><meta property="article:tag" content="Драматург"><meta property="article:tag" content="Веб-Гусеница"><meta property="article:tag" content="Автоматизация Браузера"><meta property="article:tag" content="Антикроулер"><meta property="article:tag" content="MCP"><meta name=twitter:card content="summary"><meta name=twitter:title content="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><meta name=twitter:description content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих “кирпичных стен”, но если я скажу вам, что существует способ напрямую “позаимствовать” ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?"><link rel=stylesheet href=/css/output.min.css><style>pre{padding:1em;overflow:auto}</style><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin=anonymous></script></head><body x-data="{
    flip: false,
  }"><div id=dream-global-bg></div><nav x-data="{ isSticky: false }" x-init="window.addEventListener('scroll', () => { isSticky = window.scrollY > 30 })" class="sticky top-0 z-30 mt-4 lg:mt-8 py-4" :class="{ 'bg-base-100 shadow-lg dark:border-b dark:border-base-content/30': isSticky }"><div class="container flex justify-between px-4"><section class="flex items-center gap-4"><div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title=Повернуть!><div class="h-10 rounded-full"><img src=/favicon.ico alt=爱解决></div></div><div><a href=/ru class="text-lg font-semibold cursor-pointer">爱解决</a><div class="text-base-content/60 text-sm">用AI为人民服务</div></div></section><div class="dropdown dropdown-end sm:hidden"><div tabindex=0 role=button class="btn btn-ghost btn-square" aria-label="Select an option"><ion-icon name=menu class=text-2xl></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md"><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/index.xml title=RSS><ion-icon name=logo-rss></ion-icon>RSS</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/posts title=Архивы><ion-icon name=archive></ion-icon>Архивы</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/tags title="Все теги"><ion-icon name=pricetags></ion-icon>Все теги</a></li></ul></div><section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/ru/index.xml title=RSS><ion-icon class=group-hover:text-primary-content name=logo-rss></ion-icon></a><div class="dropdown dropdown-end dropdown-hover"><div tabindex=0 role=button class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" aria-label="Select an option"><ion-icon class="group-hover:text-primary-content text-xl" name=menu></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-xl"><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/posts title=Архивы><ion-icon name=archive></ion-icon>Архивы</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/ru/tags title="Все теги"><ion-icon name=pricetags></ion-icon>Все теги</a></li></ul></div><div class="dropdown dropdown-end dropdown-hover language-switcher"><div tabindex=0 role=button class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" title="Переключить язык"><ion-icon class=group-hover:text-primary-content name=language-outline></ion-icon><span class="ml-1 hidden md:inline group-hover:text-primary-content language-name">Русский</span></div><ul tabindex=0 class="dropdown-content menu bg-base-100 rounded-box z-[1] shadow-xl border border-base-content/20" style=min-width:6rem;width:auto><li><a href=/zh/2025/07/playwright-bypass-login-crawler/ class="flex items-center gap-2"><span class="flag flag-cn"></span>
<span class=language-name>中文</span></a></li></ul></div></section></div></nav><div class=flip-container :class="{ 'flip-it': flip }"><div class=flipper><div class=front><div class=container><div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4"><div class="hidden lg:block"></div><div class=lg:col-span-2><article class="mx-auto prose prose-quoteless dark:prose-invert" id=dream-single-post-main itemscope itemtype=http://schema.org/Article><meta itemprop=name content="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><meta itemprop=description content="Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих “кирпичных стен”, но если я скажу вам, что существует способ напрямую “позаимствовать” ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?"><meta itemprop=datePublished content="2025-07-05T16:19:16+04:00"><meta itemprop=dateModified content="2025-08-13T15:03:02+00:00"><meta itemprop=wordCount content="9356"><meta itemprop=keywords content="Драматург,Веб-Гусеница,Автоматизация Браузера,Антикроулер,MCP"><header><h1 itemprop=headline>Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright</h1><p class=text-sm><span data-format=luxon>2025-07-05T16:19:16+04:00</span>
| <span>19 минут чтения</span>
| <span>Обновлено
<span data-format=luxon>2025-08-13T15:03:02Z</span></span></p><div class="flex justify-between"><div class="flex items-center"><span>@</span>
<span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=name>董昊</span></span></div><div class="flex items-center gap-2"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://x.com/intent/post?text=%d0%a0%d0%b0%d0%b7%d1%80%d1%83%d1%88%d0%b0%d1%8f%20%d0%b3%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%8b%20%d1%82%d1%80%d0%b0%d0%b4%d0%b8%d1%86%d0%b8%d0%be%d0%bd%d0%bd%d1%8b%d1%85%20%d0%ba%d1%80%d0%b0%d1%83%d0%bb%d0%b5%d1%80%d0%be%d0%b2:%20%d0%ba%d0%be%d0%bc%d0%bf%d0%bb%d0%b5%d0%ba%d1%81%d0%bd%d0%be%d0%b5%20%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%bb%d1%8f%20%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%b1%d1%80%d0%b0%d1%83%d0%b7%d0%b5%d1%80%d0%b0%20%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f%20%d0%ba%20%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b5%20%d0%b2%d1%85%d0%be%d0%b4%d0%b0%20%d0%b2%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d1%81%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e%20Playwright&amp;url=https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/" target=_blank rel="noopener noreferrer" title="Share on X"><ion-icon class=group-hover:text-primary-content name=logo-x></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://facebook.com/sharer/sharer.php?u=https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/" target=_blank rel="noopener noreferrer" title="Share on Facebook"><ion-icon class=group-hover:text-primary-content name=logo-facebook></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://wa.me/?text=%d0%a0%d0%b0%d0%b7%d1%80%d1%83%d1%88%d0%b0%d1%8f%20%d0%b3%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d1%8b%20%d1%82%d1%80%d0%b0%d0%b4%d0%b8%d1%86%d0%b8%d0%be%d0%bd%d0%bd%d1%8b%d1%85%20%d0%ba%d1%80%d0%b0%d1%83%d0%bb%d0%b5%d1%80%d0%be%d0%b2:%20%d0%ba%d0%be%d0%bc%d0%bf%d0%bb%d0%b5%d0%ba%d1%81%d0%bd%d0%be%d0%b5%20%d1%80%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5%20%d0%b4%d0%bb%d1%8f%20%d0%bf%d0%be%d0%b4%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d1%8f%20%d0%b1%d1%80%d0%b0%d1%83%d0%b7%d0%b5%d1%80%d0%b0%20%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8f%20%d0%ba%20%d1%81%d1%82%d1%80%d0%b0%d0%bd%d0%b8%d1%86%d0%b5%20%d0%b2%d1%85%d0%be%d0%b4%d0%b0%20%d0%b2%20%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc%d1%83%20%d1%81%20%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e%20Playwright%20https://jiejue.ai/ru/2025/07/playwright-bypass-login-crawler/" target=_blank rel="noopener noreferrer" title="Share on WhatsApp"><ion-icon class=group-hover:text-primary-content name=logo-whatsapp></ion-icon></a></div></div></header><section id=dream-single-post-content itemprop=articleBody><img class="w-full z-30" src=https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250705162011982.webp alt="Разрушая границы традиционных краулеров: комплексное решение для подключения браузера пользователя к странице входа в систему с помощью Playwright"><p>Представьте себе такой сценарий: вы хотите автоматически получить информацию о заказах на Taobao, личные сообщения в Twitter или пакетное управление внутренними системами, но эти сайты либо требуют сложной аутентификации при входе, либо имеют мощный механизм защиты от краулеров. Традиционные краулеры часто оказываются беспомощными перед лицом этих &ldquo;кирпичных стен&rdquo;, но если я скажу вам, что существует способ напрямую &ldquo;позаимствовать&rdquo; ваш браузер, используя ваш статус входа в систему для доступа к этим страницам, вы подумаете, что это удивительно?</p><p>&lt;! -еще&ndash;></p><h2 id=дилемма-традиционных-краулеров>Дилемма традиционных краулеров</h2><p>Как разработчик, вы наверняка сталкивались с этой головной болью:</p><ul><li><strong>Сложная проверка логина</strong>: CAPTCHA, SMS-проверка, человеко-машинная проверка - бесконечное множество вариантов.</li><li><strong>Строгое обнаружение антикраулеров</strong>: обнаружение User-Agent, ограничение частоты, блокировка IP-адресов</li><li><strong>Сложности в управлении сессиями</strong>: истечение срока действия куки, обновление токенов, многоступенчатая аутентификация</li><li><strong>Приватное содержимое недоступно</strong>: личная домашняя страница, личные сообщения, управление фоном и другие страницы, требующие разрешений.</li></ul><p>Проблемы у сотрудника отдела электронной коммерции: ему нужно каждый день проверять данные о магазине на нескольких платформах, вручную входить, проверять, записывать и тратить кучу времени на повторяющийся труд. А при написании краулера приходится заниматься всевозможными проверками, что требует больших затрат.</p><h2 id=революционное-решение-playwright>Революционное решение Playwright</h2><p>Playwright предлагает гениальное решение: <strong>подключиться к существующему экземпляру браузера пользователя</strong>. Это как &ldquo;прикрепление&rdquo; к вашему браузеру и использование вашего статуса входа, куки и даже расширений браузера.</p><h3 id=основной-принцип-протокол-chrome-devtools-protocol-cdp>Основной принцип: протокол Chrome DevTools Protocol (CDP)</h3><p>Современные браузеры поддерживают протокол CDP, который изначально был создан для инструментов разработчика, но мы можем &ldquo;позаимствовать&rdquo; его для реализации программного управления браузером.</p><pre class=mermaid>
  graph LR
    A[用户浏览器] --&gt;|CDP端口9222| B[Playwright脚本]
    B --&gt; C[读取页面内容]
    B --&gt; D[执行用户操作]
    B --&gt; E[获取登录状态]
    
    A --&gt; F[保留所有设置]
    F --&gt; G[Cookie]
    F --&gt; H[登录状态]
    F --&gt; I[浏览器扩展]
```.

## Практическое демо: полная реализация от нуля до одного

### Первый шаг: запуск браузера в режиме отладки

Это критически важный первый шаг во всей программе. Вам нужно разрешить браузеру открыть &#34;черный ход&#34;, чтобы позволить внешним приложениям подключаться.

**На macOS: **
```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222
```.

**На Windows:** ```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222
```.
```cmd
chrome.exe --remote-debugging-port=9222
```.

**```cmd
chrome.exe --remote-debugging-port=9222
``` **On Linux.
```bash
google-chrome --remote-debugging-port=9222
```.

Если вы видите вывод, подобный этому, значит, все прошло успешно:
</pre><p>DevTools listening on ws://127.0.0.1:9222/devtools/browser/8d2806ff-58c5-43b7-b9f4-eadfdbfe87cf</p><pre tabindex=0><code>
### Шаг 2: Проверьте соединение

Зайдите на страницу `http://localhost:9222/json/version` в браузере, и если вы увидите ответ в формате JSON, значит, порт отладки открыт.

### Шаг 3: Напишите скрипт подключения

Здесь представлены две версии реализации:

#### JavaScript-версия (рекомендуется для начинающих).

```javascript
const { chromium } = require(&#39;playwright&#39;);

async function connectToUserBrowser() {
    console.log(&#39;正在连接到你的浏览器...&#39;);
    
    try {
        // 连接到用户的浏览器实例
        const browser = await chromium.connectOverCDP(&#39;http://localhost:9222&#39;);
        console.log(&#39;连接成功！&#39;);
        
        // 获取现有的浏览器上下文（包含所有登录状态）
        const context = browser.contexts()[0];
        
        // 获取当前页面或创建新页面
        let page;
        const pages = context.pages();
        if (pages.length &gt; 0) {
            page = pages[0]; // 使用现有页面
            console.log(`当前页面：${await page.title()}`);
        } else {
            page = await context.newPage(); // 创建新页面
        }
        
        // 示例：访问需要登录的淘宝页面
        await page.goto(&#39;https://www.taobao.com&#39;);
        
        // 检查登录状态
        const isLoggedIn = await page.locator(&#39;.site-nav-user&#39;).isVisible();
        if (isLoggedIn) {
            console.log(&#39;检测到已登录淘宝！&#39;);
            
            // 获取用户信息
            const username = await page.locator(&#39;.site-nav-user&#39;).textContent();
            console.log(`用户名：${username}`);
            
            // 现在可以访问个人中心、订单页面等
            await page.goto(&#39;https://trade.taobao.com/trade/itemlist/list_bought_items.htm&#39;);
            console.log(&#39;成功访问订单页面！&#39;);
        }
        
    } catch (error) {
        console.error(&#39;连接失败：&#39;, error.message);
        console.log(&#39;请确保浏览器已开启调试模式&#39;);
    }
}

connectToUserBrowser();
</code></pre><h4 id=версия-на-языке-python-для-аналитиков-данных>Версия на языке Python (для аналитиков данных)</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> asyncio
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> playwright.async_api <span style=color:#f92672>import</span> async_playwright
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>connect_to_user_browser</span>():
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;正在连接到你的浏览器...&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>with</span> async_playwright() <span style=color:#66d9ef>as</span> p:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            <span style=color:#75715e># 连接到用户浏览器</span>
</span></span><span style=display:flex><span>            browser <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> p<span style=color:#f92672>.</span>chromium<span style=color:#f92672>.</span>connect_over_cdp(<span style=color:#e6db74>&#39;http://localhost:9222&#39;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#39;连接成功！&#39;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># 获取现有上下文</span>
</span></span><span style=display:flex><span>            context <span style=color:#f92672>=</span> browser<span style=color:#f92672>.</span>contexts[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># 创建新页面</span>
</span></span><span style=display:flex><span>            page <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> context<span style=color:#f92672>.</span>new_page()
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># 访问微博</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> page<span style=color:#f92672>.</span>goto(<span style=color:#e6db74>&#39;https://weibo.com&#39;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#75715e># 检查登录状态</span>
</span></span><span style=display:flex><span>            login_element <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> page<span style=color:#f92672>.</span>query_selector(<span style=color:#e6db74>&#39;.login&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> login_element:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#39;检测到已登录微博！&#39;</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e># 获取微博数据</span>
</span></span><span style=display:flex><span>                posts <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> page<span style=color:#f92672>.</span>query_selector_all(<span style=color:#e6db74>&#39;.card-wrap&#39;</span>)
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;获取到 </span><span style=color:#e6db74>{</span>len(posts)<span style=color:#e6db74>}</span><span style=color:#e6db74> 条微博&#39;</span>)
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>                <span style=color:#75715e># 处理每条微博</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> i, post <span style=color:#f92672>in</span> enumerate(posts[:<span style=color:#ae81ff>5</span>]):  <span style=color:#75715e># 只处理前5条</span>
</span></span><span style=display:flex><span>                    text <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> post<span style=color:#f92672>.</span>inner_text()
</span></span><span style=display:flex><span>                    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;微博 </span><span style=color:#e6db74>{</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>text[:<span style=color:#ae81ff>50</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>...&#39;</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> error:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;连接失败：</span><span style=color:#e6db74>{</span>error<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 运行</span>
</span></span><span style=display:flex><span>asyncio<span style=color:#f92672>.</span>run(connect_to_user_browser())
</span></span></code></pre></div><h2 id=фактические-тестовые-данные-проверка-реального-случая>Фактические тестовые данные: проверка реального случая</h2><p>В реальном тесте я использовал эту схему для успешного подключения к браузеру Vivaldi, содержащему 89 вкладок, и получил следующие результаты:</p><h3 id=успешный-доступ-к-приватному-содержимому>Успешный доступ к приватному содержимому:</h3><ol><li><p><strong>Личное пространство на сайте B</strong></p><ul><li>Поклонники: 265</li><li>Количество просмотров: 348,000</li><li>Последние видеоматериалы</li><li>Персональная статистика</li></ul></li><li><p><strong>Личная хронология Twitter</strong></p><ul><li>Домашняя страница личного аккаунта</li><li>Приватный рекомендуемый контент</li><li>Сообщения уведомлений</li></ul></li><li><p><strong>Администрирование бэкэнда WordPress</strong></p><ul><li>Полный интерфейс администратора</li><li>Доступ к редактированию статей</li><li>Доступ к конфигурации сайта</li></ul></li><li><p><strong>Личный чат Клода.ai</strong></p><ul><li>Технические обсуждения, содержащие 288 блоков кода</li><li>Приватный обмен связанным контентом</li><li>Полная история диалога</li></ul></li></ol><h3 id=данные-о-производительности>Данные о производительности:</h3><ul><li><strong>Скорость соединения</strong>: &lt; 2 секунд</li><li><strong>Загрузка страниц</strong>: такая же, как в обычном браузере</li><li><strong>Стабильность</strong>: сохраняется в течение нескольких часов</li><li><strong>Совместимость</strong>: поддержка Chrome, Edge, Vivaldi и других браузеров на ядре Chromium.</li></ul><h2 id=расширение-возможностей-искусственного-интеллекта-с-помощью-mcp>Расширение возможностей искусственного интеллекта с помощью MCP</h2><p>Если вы используете ИИ-помощника, например Claude, вы также можете позволить ему управлять браузером напрямую через MCP (Model Context Protocol). Это революционная функция, которая позволяет ИИ фактически &ldquo;видеть&rdquo; и &ldquo;манипулировать&rdquo; веб-страницами.</p><h3 id=настройте-mcp-одним-щелчком-мыши>Настройте MCP одним щелчком мыши</h3><p>Для клиентов ИИ, поддерживающих MCP, таких как Claude Desktop, Cline и т. д., достаточно добавить следующую конфигурацию JSON в файл конфигурации:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;mcpServers&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Playwright&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;npx&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;args&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;-y&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;@playwright/mcp@latest&#34;</span>
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>```.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Когда</span> <span style=color:#960050;background-color:#1e0010>конфигурация</span> <span style=color:#960050;background-color:#1e0010>будет</span> <span style=color:#960050;background-color:#1e0010>завершена,</span> <span style=color:#960050;background-color:#1e0010>ИИ</span> <span style=color:#960050;background-color:#1e0010>сможет</span> <span style=color:#960050;background-color:#1e0010>напрямую</span> <span style=color:#960050;background-color:#1e0010>вызывать</span> <span style=color:#960050;background-color:#1e0010>функцию</span> <span style=color:#960050;background-color:#1e0010>Playwright:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>```javascript</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// AI可以直接执行这些操作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>Playwright.browser_navigate(</span><span style=color:#e6db74>&#34;https://example.com&#34;</span><span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>Playwright.browser_type(</span><span style=color:#e6db74>&#34;搜索框选择器&#34;</span><span style=color:#960050;background-color:#1e0010>,</span> <span style=color:#e6db74>&#34;搜索内容&#34;</span><span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>Playwright.browser_click(</span><span style=color:#e6db74>&#34;提交按钮选择器&#34;</span><span style=color:#960050;background-color:#1e0010>);</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>await</span> <span style=color:#960050;background-color:#1e0010>Playwright.browser_take_screenshot();</span>
</span></span></code></pre></div><h3 id=уникальные-преимущества-mcp>Уникальные преимущества MCP</h3><p>ИИ, управляющий браузером с помощью MCP, имеет следующие преимущества перед традиционными методами программирования:</p><ol><li><strong>Управление на естественном языке</strong>: Вы можете напрямую сказать ИИ &ldquo;помогите мне войти на Taobao и проверить последние заказы&rdquo;.</li><li><strong>Интеллектуальная адаптация</strong>: ИИ может автоматически корректировать стратегию работы в зависимости от структуры страницы.</li><li><strong>Обработка ошибок</strong>: ИИ может автоматически повторять попытки и обрабатывать исключения.</li><li><strong>Мгновенная обратная связь</strong>: ИИ может анализировать содержимое страницы и принимать решения в режиме реального времени.</li></ol><p>Таким образом, ИИ может управлять веб-страницами как человек и выполнять сложные автоматизированные задачи.</p><h2 id=сценарии-применения-решение-реальных-проблем>Сценарии применения: решение реальных проблем</h2><h3 id=1-автоматизация-работы-электронной-коммерции>1. Автоматизация работы электронной коммерции</h3><p><strong>Сценарий</strong>: Сяо Ван управляет магазинами на 10 различных платформах и должен ежедневно проверять заказы, отвечать на запросы клиентов и обновлять товары.</p><p><strong>Решение</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 自动检查各平台订单
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>platforms</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;taobao&#39;</span>, <span style=color:#e6db74>&#39;jd&#39;</span>, <span style=color:#e6db74>&#39;pinduoduo&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>platform</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>platforms</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>checkOrders</span>(<span style=color:#a6e22e>platform</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>replyMessages</span>(<span style=color:#a6e22e>platform</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>updateInventory</span>(<span style=color:#a6e22e>platform</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#e6db74>```.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### 2. Управление социальными сетями
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>**Сценарий**: Создателям контента необходимо синхронно публиковать материалы на Weibo, Xiaohongshu, Jieyin и других платформах.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>**Решение**:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>```</span><span style=color:#a6e22e>javascript</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 批量发布内容
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>content</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;今天分享一个实用技巧...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>images</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;image1.jpg&#34;</span>, <span style=color:#e6db74>&#34;image2.jpg&#34;</span>]
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>publishToWeibo</span>(<span style=color:#a6e22e>content</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>publishToXiaohongshu</span>(<span style=color:#a6e22e>content</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>publishToDouyin</span>(<span style=color:#a6e22e>content</span>);
</span></span><span style=display:flex><span><span style=color:#e6db74>```.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### 3. Автоматизация внутренних систем предприятия
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>**Сценарий**: отделу кадров необходимо еженедельно обновлять информацию о сотрудниках и формировать отчеты в нескольких системах.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>**Решение**:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>```</span><span style=color:#a6e22e>javascript</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 自动化HR流程
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>updateEmployeeInfo</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>generateWeeklyReport</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>submitToApprovalSystem</span>();
</span></span><span style=display:flex><span><span style=color:#e6db74>```.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>## Безопасность и соответствие нормативным требованиям
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### Меры безопасности
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1. **Локальная работа**: все операции выполняются локально, и утечка данных исключена
</span></span></span><span style=display:flex><span><span style=color:#e6db74>2. **Авторизация пользователя**: требуется, чтобы пользователи активно открывали порт отладки
</span></span></span><span style=display:flex><span><span style=color:#e6db74>3. **Прозрачность и контролируемость**: пользователи могут просматривать и останавливать работу скрипта в любое время.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>4. **Наследование привилегий**: использование существующих прав пользователя, не превышающих права доступа
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### Рекомендации по соответствию
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1. **Соблюдение условий сайта**: убедитесь, что автоматическое поведение соответствует условиям использования сайта.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>2. **Контроль частоты**: избегайте слишком частых запросов.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>3. **Защита данных**: обращайтесь с полученными данными надлежащим образом, чтобы защитить конфиденциальность.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>4. **Коммерческое использование**: перед коммерческим использованием ознакомьтесь с соответствующими юридическими условиями.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>## Часто задаваемые вопросы
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### Вопрос: В чем преимущества этого метода перед традиционными краулерами?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>О: К основным преимуществам относятся:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- **Нет входа**: напрямую используйте существующий статус входа.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- **Антиобнаружение**: используется реальная среда браузера, нелегко быть распознанным
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- **Полная функциональность**: поддержка JavaScript, Cookie, Session и т.д.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- **Поддержка плагинов**: можно использовать преимущества расширений браузера, таких как блокировщики рекламы
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### Q: Повлияет ли это на нормальное использование браузера?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>О: Нет. Скрипт просто &#34;прикрепляется&#34; к браузеру, и вы можете просматривать веб-страницы в обычном режиме. Новые вкладки, созданные скриптом, будут четко обозначены.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### Q: Какие браузеры поддерживаются?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>О: Поддерживаются все браузеры на базе Chromium:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- Google Chrome
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- Microsoft Edge
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- Vivaldi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- Вивальди
</span></span></span><span style=display:flex><span><span style=color:#e6db74>- Opera
</span></span></span><span style=display:flex><span><span style=color:#e6db74>и т.д.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>### Q: Как работать с динамическим содержимым на странице?
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>О: В Playwright есть мощный встроенный механизм ожидания:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>```</span><span style=color:#a6e22e>javascript</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 等待元素出现
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForSelector</span>(<span style=color:#e6db74>&#39;.dynamic-content&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 等待网络请求完成
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForLoadState</span>(<span style=color:#e6db74>&#39;networkidle&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 等待特定条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForFunction</span>(() =&gt; window.<span style=color:#a6e22e>dataLoaded</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>true</span>);
</span></span></code></pre></div><h3 id=q-где-находится-файл-конфигурации-mcp>Q: Где находится файл конфигурации MCP?</h3><p>О: Расположение файла конфигурации для разных клиентов:</p><p><strong>Claude Desktop:</strong>.</p><ul><li>macOS: <code>~/Library/Application Support/Claude/claude_desktop_config.json</code></li><li>Windows: <code>%APPDATA%\Claude\claude_desktop_config.json</code></li></ul><p><strong>Клин (плагин для VS Code):</strong>.</p><ul><li>Откройте Settings в VS Code и найдите &ldquo;Cline: MCP&rdquo;.</li><li>или просто отредактируйте рабочее пространство <code>.vscode/settings.json</code>.</li></ul><p>Просто добавьте конфигурацию JSON в соответствующий файл.</p><h2 id=дополнительные-советы>Дополнительные советы</h2><h3 id=1-пакетная-обработка-нескольких-учетных-записей>1. Пакетная обработка нескольких учетных записей</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 使用不同的用户数据目录
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>contexts</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>9222</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;账号1&#39;</span> },
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>9223</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;账号2&#39;</span> },
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>9224</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;账号3&#39;</span> }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ctx</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>contexts</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>browser</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>chromium</span>.<span style=color:#a6e22e>connectOverCDP</span>(<span style=color:#e6db74>`http://localhost:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>port</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>processAccount</span>(<span style=color:#a6e22e>browser</span>, <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>name</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=2-обработка-ошибок-и-механизм-повторных-попыток>2. Обработка ошибок и механизм повторных попыток</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>robustOperation</span>(<span style=color:#a6e22e>page</span>, <span style=color:#a6e22e>operation</span>, <span style=color:#a6e22e>maxRetries</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>maxRetries</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>operation</span>(<span style=color:#a6e22e>page</span>);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`尝试 </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> 失败：</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>maxRetries</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>page</span>.<span style=color:#a6e22e>waitForTimeout</span>(<span style=color:#ae81ff>1000</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)); <span style=color:#75715e>// 递增延迟
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=3-сохранение-данных>3. Сохранение данных</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// 保存浏览器状态供下次使用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>storageState</span>({ <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;user-session.json&#39;</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 下次直接加载状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>context</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>browser</span>.<span style=color:#a6e22e>newContext</span>({ 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>storageState</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;user-session.json&#39;</span> 
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=резюме>Резюме</h2><p>С помощью схемы подключения Playwright к браузеру пользователя мы успешно преодолели ограничения традиционных краулеров и реализовали их:</p><ol><li><strong>Непороговый вход</strong>: нет необходимости в сложном процессе аутентификации.</li><li><strong>Имитация реальной среды</strong>: использование отпечатков пальцев и настроек реального браузера.</li><li><strong>Доступ к приватному контенту</strong>: получение данных со страниц, требующих разрешений.</li><li><strong>Высокая степень автоматизации</strong>: в сочетании с искусственным интеллектом достигается интеллектуальная работа</li></ol><p>Это решение особенно подходит для индивидуальных разработчиков и небольших команд, помогая им быстро реализовать свои потребности в веб-автоматизации. Независимо от того, занимаетесь ли вы электронной коммерцией, создаете контент или являетесь ИТ-администратором предприятия, вы сможете найти подходящие сценарии его применения.</p><p>Помните, что технология нейтральна; все дело в том, как ответственно ее использовать. Наслаждаясь удобством автоматизации, важно также соблюдать условия использования сайта и конфиденциальность пользователей.</p><h2 id=список-быстрого-запуска>Список быстрого запуска</h2><p>Для читателей, которым не терпится опробовать эту технологию, мы предлагаем список для быстрого старта:</p><h3 id=базовая-версия-управление-программированием>Базовая версия (управление программированием)</h3><ol><li>☑️ Запустите браузер в режиме отладки</li><li>☑️ Установите Playwright: <strong>PROTECTED_INLINE_CODE__20</strong>.</li><li>☑️ Скопируйте пример кода из статьи.</li><li>☑️ Запустите первый тестовый скрипт</li></ol><h3 id=версия-mcp-управление-искусственным-интеллектом>Версия MCP (управление искусственным интеллектом)</h3><ol><li>☑️ Добавьте конфигурацию MCP в файл конфигурации клиента AI.</li><li>☑️ Перезапустите клиент AI.</li><li>☑️ Скажите AI напрямую: &ldquo;Пожалуйста, посетите Taobao и сделайте скриншот&rdquo;.</li></ol><p>Начните свой путь автоматизации прямо сейчас! Начните с простого посещения страницы и шаг за шагом создавайте своего специального веб-помощника.</p></section><div class=divider></div><div class="flex flex-col md:flex-row justify-between gap-4 py-4"><a role=button class="btn btn-outline h-12" href=/ru/2025/07/kubernetes-annotations-string-type-constraint/ title="Ограничения типов строк для аннотаций Kubernetes: от ошибок к пониманию"><ion-icon name=chevron-back></ion-icon><div class="inline-flex flex-col items-start"><span class="text-base-content/60 text-xs font-normal">Предыдущая</span>
<span class="max-w-48 truncate">Ограничения типов строк для аннотаций Kubernetes: от ошибок к пониманию</span></div></a><a role=button class="btn btn-outline h-12" href=/ru/2025/07/ai-time-perception-dialogue/ title="Когда ИИ начинает думать о времени: фантастический диалог о существовании"><div class="inline-flex flex-col items-end"><span class="text-base-content/60 text-xs font-normal">Следующая</span>
<span class="max-w-48 truncate">Когда ИИ начинает думать о времени: фантастический диалог о существовании</span></div><ion-icon name=chevron-forward></ion-icon></a></div><div class=divider></div><section class=space-y-4><article><div id=tcomment></div><script src=https://cdn.jsdelivr.net/npm/twikoo@1.6.41/dist/twikoo.min.js></script><script>twikoo.init({envId:"https://6dhzwvtyqz753zhpkrvnnydhlm0vubmy.lambda-url.ap-east-1.on.aws/",el:"#tcomment",region:"ap-east-1",path:"/ru/2025/07/playwright-bypass-login-crawler/",lang:"zh-CN"})</script></article></section></article></div><div x-data=tocHighlighter() @scroll.window=debouncedScroll class="hidden lg:flex lg:flex-col lg:items-end"><nav id=TableOfContents><ul><li><a href=#дилемма-традиционных-краулеров>Дилемма традиционных краулеров</a></li><li><a href=#революционное-решение-playwright>Революционное решение Playwright</a><ul><li><a href=#основной-принцип-протокол-chrome-devtools-protocol-cdp>Основной принцип: протокол Chrome DevTools Protocol (CDP)</a></li></ul></li><li><a href=#фактические-тестовые-данные-проверка-реального-случая>Фактические тестовые данные: проверка реального случая</a><ul><li><a href=#успешный-доступ-к-приватному-содержимому>Успешный доступ к приватному содержимому:</a></li><li><a href=#данные-о-производительности>Данные о производительности:</a></li></ul></li><li><a href=#расширение-возможностей-искусственного-интеллекта-с-помощью-mcp>Расширение возможностей искусственного интеллекта с помощью MCP</a><ul><li><a href=#настройте-mcp-одним-щелчком-мыши>Настройте MCP одним щелчком мыши</a></li><li><a href=#уникальные-преимущества-mcp>Уникальные преимущества MCP</a></li></ul></li><li><a href=#сценарии-применения-решение-реальных-проблем>Сценарии применения: решение реальных проблем</a><ul><li><a href=#1-автоматизация-работы-электронной-коммерции>1. Автоматизация работы электронной коммерции</a></li><li><a href=#q-где-находится-файл-конфигурации-mcp>Q: Где находится файл конфигурации MCP?</a></li></ul></li><li><a href=#дополнительные-советы>Дополнительные советы</a><ul><li><a href=#1-пакетная-обработка-нескольких-учетных-записей>1. Пакетная обработка нескольких учетных записей</a></li><li><a href=#2-обработка-ошибок-и-механизм-повторных-попыток>2. Обработка ошибок и механизм повторных попыток</a></li><li><a href=#3-сохранение-данных>3. Сохранение данных</a></li></ul></li><li><a href=#резюме>Резюме</a></li><li><a href=#список-быстрого-запуска>Список быстрого запуска</a><ul><li><a href=#базовая-версия-управление-программированием>Базовая версия (управление программированием)</a></li><li><a href=#версия-mcp-управление-искусственным-интеллектом>Версия MCP (управление искусственным интеллектом)</a></li></ul></li></ul></nav></div></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 ЛюбимРешать</p><p>一个热爱解决问题的网站</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div><div class=back><div class=container><div class="dream-grid dream-grid-about"></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 ЛюбимРешать</p><p>一个热爱解决问题的网站</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div></div></div><script>window.lightTheme="emerald",window.darkTheme="forest"</script><script src=https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin=anonymous></script><script src=/js/grid.min.js></script><script src=/js/main.min.js></script><script src=https://cdn.jsdelivr.net/npm/luxon@1.26.0 integrity="sha256-4sbTzmCCW9LGrIh5OsN8V5Pfdad1F1MwhLAOyXKnsE0=" crossorigin=anonymous></script><script>format();function format(){document.querySelectorAll('span[data-format="luxon"]').forEach(e=>{const t=e.textContent;e.textContent=luxon.DateTime.fromISO(t,{locale:"ru"}).toFormat("yyyy年MM月dd日 HH:mm")})}</script><script src=/js/toc.min.js></script><script type=module>
      import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm';
      mediumZoom('#dream-single-post-content img', {
        background: 'oklch(var(--b1))',
        margin: 24,
      })
    </script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
      </script><script async src="https://www.googletagmanager.com/gtag/js?id=G-S0KCH9BW4F"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S0KCH9BW4F")}</script><script type=module src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin=anonymous></script><script nomodule src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin=anonymous></script></body></html>