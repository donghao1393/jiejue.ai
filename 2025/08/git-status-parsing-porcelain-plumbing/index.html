<!doctype html><html lang=zh-cn x-data :class=$store.darkMode.class() :data-theme=$store.darkMode.theme()><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Git 状态解析：从美观输出到脚本友好格式的完全指南 | 爱解决</title><link href=/favicon.ico rel=icon type=image/x-icon><link rel=canonical href=https://jiejue.ai/2025/08/git-status-parsing-porcelain-plumbing/><meta name=author content="董昊"><meta name=description content='当你在终端中运行 git status 时，看到的那些彩色、格式化的输出很漂亮，对吧？但如果你想在脚本中解析这些信息，或者通过管道命令进行进一步处理，那些"美观"的格式反而成了障碍。今天我们来探索 Git 状态输出的两面性：既要美观易读，又要机器友好。
'><meta name=keywords content="Git,命令行,自动化,版本控制"><meta name=generator content="Hugo 0.148.2"><meta property="og:url" content="https://jiejue.ai/2025/08/git-status-parsing-porcelain-plumbing/"><meta property="og:site_name" content="爱解决"><meta property="og:title" content="Git 状态解析：从美观输出到脚本友好格式的完全指南"><meta property="og:description" content='当你在终端中运行 git status 时，看到的那些彩色、格式化的输出很漂亮，对吧？但如果你想在脚本中解析这些信息，或者通过管道命令进行进一步处理，那些"美观"的格式反而成了障碍。今天我们来探索 Git 状态输出的两面性：既要美观易读，又要机器友好。'><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-13T20:09:53+04:00"><meta property="article:modified_time" content="2025-08-13T20:15:32+04:00"><meta property="article:tag" content="Git"><meta property="article:tag" content="命令行"><meta property="article:tag" content="自动化"><meta property="article:tag" content="版本控制"><meta name=twitter:card content="summary"><meta name=twitter:title content="Git 状态解析：从美观输出到脚本友好格式的完全指南"><meta name=twitter:description content='当你在终端中运行 git status 时，看到的那些彩色、格式化的输出很漂亮，对吧？但如果你想在脚本中解析这些信息，或者通过管道命令进行进一步处理，那些"美观"的格式反而成了障碍。今天我们来探索 Git 状态输出的两面性：既要美观易读，又要机器友好。'><link rel=stylesheet href=/css/output.min.css><style>pre{padding:1em;overflow:auto}</style><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin=anonymous></script></head><body x-data="{
    flip: false,
  }"><div id=dream-global-bg></div><nav x-data="{ isSticky: false }" x-init="window.addEventListener('scroll', () => { isSticky = window.scrollY > 30 })" class="sticky top-0 z-30 mt-4 lg:mt-8 py-4" :class="{ 'bg-base-100 shadow-lg dark:border-b dark:border-base-content/30': isSticky }"><div class="container flex justify-between px-4"><section class="flex items-center gap-4"><div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title=翻转一下！><div class="h-10 rounded-full"><img src=/favicon.ico alt=爱解决></div></div><div><a href=https://jiejue.ai/ class="text-lg font-semibold cursor-pointer">爱解决</a><div class="text-base-content/60 text-sm">用AI为人民服务</div></div></section><div class="dropdown dropdown-end sm:hidden"><div tabindex=0 role=button class="btn btn-ghost btn-square" aria-label="Select an option"><ion-icon name=menu class=text-2xl></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md"><li><a class="group inline-flex items-center p-2 cursor-pointer" href=/search title=搜索><ion-icon name=search></ion-icon>搜索</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/index.xml title=RSS><ion-icon name=logo-rss></ion-icon>RSS</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/posts title=归档><ion-icon name=archive></ion-icon>归档</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/tags title=所有标签><ion-icon name=pricetags></ion-icon>所有标签</a></li></ul></div><section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/search title=搜索><ion-icon class=group-hover:text-primary-content name=search></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/index.xml title=RSS><ion-icon class=group-hover:text-primary-content name=logo-rss></ion-icon></a><div class="dropdown dropdown-end dropdown-hover"><div tabindex=0 role=button class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" aria-label="Select an option"><ion-icon class="group-hover:text-primary-content text-xl" name=menu></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-xl"><li><a class="inline-flex items-center p-2 cursor-pointer" href=/posts title=归档><ion-icon name=archive></ion-icon>归档</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/tags title=所有标签><ion-icon name=pricetags></ion-icon>所有标签</a></li></ul></div></section></div></nav><div class=flip-container :class="{ 'flip-it': flip }"><div class=flipper><div class=front><div class=container><div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4"><div class="hidden lg:block"></div><div class=lg:col-span-2><article class="mx-auto prose prose-quoteless dark:prose-invert" id=dream-single-post-main itemscope itemtype=http://schema.org/Article><meta itemprop=name content="Git 状态解析：从美观输出到脚本友好格式的完全指南"><meta itemprop=description content='当你在终端中运行 git status 时，看到的那些彩色、格式化的输出很漂亮，对吧？但如果你想在脚本中解析这些信息，或者通过管道命令进行进一步处理，那些"美观"的格式反而成了障碍。今天我们来探索 Git 状态输出的两面性：既要美观易读，又要机器友好。'><meta itemprop=datePublished content="2025-08-13T20:09:53+04:00"><meta itemprop=dateModified content="2025-08-13T20:15:32+04:00"><meta itemprop=wordCount content="2149"><meta itemprop=keywords content="Git,命令行,自动化,版本控制"><header><h1 itemprop=headline>Git 状态解析：从美观输出到脚本友好格式的完全指南</h1><p class=text-sm><span data-format=luxon>2025-08-13T20:09:53+04:00</span>
| <span>5分钟阅读</span>
| <span>更新于
<span data-format=luxon>2025-08-13T20:15:32+04:00</span></span></p><div class="flex justify-between"><div class="flex items-center"><span>@</span>
<span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=name>董昊</span></span></div><div class="flex items-center gap-2"><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://x.com/intent/post?text=Git%20%e7%8a%b6%e6%80%81%e8%a7%a3%e6%9e%90%ef%bc%9a%e4%bb%8e%e7%be%8e%e8%a7%82%e8%be%93%e5%87%ba%e5%88%b0%e8%84%9a%e6%9c%ac%e5%8f%8b%e5%a5%bd%e6%a0%bc%e5%bc%8f%e7%9a%84%e5%ae%8c%e5%85%a8%e6%8c%87%e5%8d%97&amp;url=https://jiejue.ai/2025/08/git-status-parsing-porcelain-plumbing/" target=_blank rel="noopener noreferrer" title="Share on X"><ion-icon class=group-hover:text-primary-content name=logo-x></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://facebook.com/sharer/sharer.php?u=https://jiejue.ai/2025/08/git-status-parsing-porcelain-plumbing/" target=_blank rel="noopener noreferrer" title="Share on Facebook"><ion-icon class=group-hover:text-primary-content name=logo-facebook></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="https://wa.me/?text=Git%20%e7%8a%b6%e6%80%81%e8%a7%a3%e6%9e%90%ef%bc%9a%e4%bb%8e%e7%be%8e%e8%a7%82%e8%be%93%e5%87%ba%e5%88%b0%e8%84%9a%e6%9c%ac%e5%8f%8b%e5%a5%bd%e6%a0%bc%e5%bc%8f%e7%9a%84%e5%ae%8c%e5%85%a8%e6%8c%87%e5%8d%97%20https://jiejue.ai/2025/08/git-status-parsing-porcelain-plumbing/" target=_blank rel="noopener noreferrer" title="Share on WhatsApp"><ion-icon class=group-hover:text-primary-content name=logo-whatsapp></ion-icon></a></div></div></header><section id=dream-single-post-content itemprop=articleBody><img class="w-full z-30" src=https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250813201401572.webp alt="Git 状态解析：从美观输出到脚本友好格式的完全指南"><p>当你在终端中运行 <code>git status</code> 时，看到的那些彩色、格式化的输出很漂亮，对吧？但如果你想在脚本中解析这些信息，或者通过管道命令进行进一步处理，那些"美观"的格式反而成了障碍。今天我们来探索 Git 状态输出的两面性：既要美观易读，又要机器友好。</p><h2 id=问题的起源两种不同的需求>问题的起源：两种不同的需求</h2><p>想象一下这个场景：你是一名开发者，需要写一个自动化脚本来检查项目中的未跟踪文件。你首先想到的可能是解析 <code>git status</code> 的输出，但很快你就会发现一个问题——那些为人类设计的输出格式对脚本来说并不友好。</p><h3 id=普通的-git-status-输出>普通的 git status 输出</h3><p>当我们运行普通的 <code>git status</code> 命令时，我们看到的是这样的输出：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch main
</span></span><span style=display:flex><span>Your branch is up to date with <span style=color:#e6db74>&#39;origin/main&#39;</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Changes to be committed:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git reset HEAD &lt;file&gt;...&#34;</span> to unstage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        new file:   src/app.js
</span></span><span style=display:flex><span>        modified:   README.md
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Changes not staged <span style=color:#66d9ef>for</span> commit:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git checkout -- &lt;file&gt;...&#34;</span> to discard changes in working directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        modified:   package.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Untracked files:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add &lt;file&gt;...&#34;</span> to include in what will be committed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        temp.log
</span></span><span style=display:flex><span>        debug.txt
</span></span></code></pre></div><p>这种输出对人类来说很友好——有颜色、有说明、有建议的操作指令。但对脚本来说就是噩梦了：</p><ul><li>包含大量解释性文字</li><li>输出格式可能因 Git 版本而变化</li><li>难以准确提取文件名</li><li>包含 ANSI 颜色代码</li></ul><h2 id=git-的双重设计哲学porcelain-vs-plumbing>Git 的双重设计哲学：Porcelain vs Plumbing</h2><p>这时候我们需要了解 Git 的设计哲学。Git 将其命令分为两类，这个命名来自一个有趣的比喻：</p><pre class=mermaid>
  graph TD
    A[&#34;🚿 Porcelain Commands&lt;br/&gt;(瓷器命令)&#34;] --&gt; A1[&#34;git add&#34;]
    A --&gt; A2[&#34;git commit&#34;]
    A --&gt; A3[&#34;git status&#34;]
    A --&gt; A4[&#34;git log&#34;]
    
    B[&#34;🔧 Plumbing Commands&lt;br/&gt;(管道命令)&#34;] --&gt; B1[&#34;git hash-object&#34;]
    B --&gt; B2[&#34;git cat-file&#34;]
    B --&gt; B3[&#34;git update-index&#34;]
    B --&gt; B4[&#34;git write-tree&#34;]
    
    A1 -.-&gt; B1
    A2 -.-&gt; B4
    A3 -.-&gt; B3
    A4 -.-&gt; B2
    
    style A fill:#e1f5fe
    style B fill:#fff3e0
</pre><h3 id=porcelain瓷器命令>Porcelain（瓷器）命令</h3><p>就像浴室里漂亮的瓷质洁具一样：</p><ul><li><strong>美观易用</strong>：为人类用户设计的友好界面</li><li><strong>功能丰富</strong>：包含帮助信息、颜色、格式化输出</li><li><strong>经常使用</strong>：日常工作的主要工具</li></ul><h3 id=plumbing管道命令>Plumbing（管道）命令</h3><p>就像隐藏在墙后的管道系统：</p><ul><li><strong>功能性强</strong>：提供核心功能，输出简洁</li><li><strong>稳定可靠</strong>：格式不会轻易改变，适合脚本使用</li><li><strong>底层工具</strong>：为上层命令提供基础功能</li></ul><h2 id=解决方案--porcelain-选项>解决方案：<code>--porcelain</code> 选项</h2><p>这里有个有趣的命名"矛盾"：<code>git status --porcelain</code> 选项实际上让一个 porcelain 命令表现得像 plumbing 命令一样！</p><h3 id=获取机器友好的状态输出>获取机器友好的状态输出</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 脚本友好的输出</span>
</span></span><span style=display:flex><span>$ git status --porcelain
</span></span><span style=display:flex><span>A  src/app.js
</span></span><span style=display:flex><span>M  README.md
</span></span><span style=display:flex><span> M package.json
</span></span><span style=display:flex><span>?? temp.log
</span></span><span style=display:flex><span>?? debug.txt
</span></span></code></pre></div><p>看到区别了吗？这种输出：</p><ul><li>没有多余的文字说明</li><li>每行一个文件，格式固定</li><li>状态用简单的字符标记</li><li>保证向后兼容</li></ul><h3 id=状态代码解释>状态代码解释</h3><pre class=mermaid>
  graph LR
    A[&#34;第一列&lt;br/&gt;暂存区状态&#34;] --&gt; A1[&#34;A - 新增&#34;]
    A --&gt; A2[&#34;M - 修改&#34;]
    A --&gt; A3[&#34;D - 删除&#34;]
    A --&gt; A4[&#34;R - 重命名&#34;]
    A --&gt; A5[&#34;C - 复制&#34;]
    A --&gt; A6[&#34;U - 未合并&#34;]
    
    B[&#34;第二列&lt;br/&gt;工作区状态&#34;] --&gt; B1[&#34;M - 修改&#34;]
    B --&gt; B2[&#34;D - 删除&#34;]
    B --&gt; B3[&#34;?? - 未跟踪&#34;]
    
    style A fill:#e8f5e8
    style B fill:#fff5e6
</pre><h2 id=实际应用提取未跟踪文件列表>实际应用：提取未跟踪文件列表</h2><p>现在我们可以轻松获取只包含文件名的未跟踪文件列表：</p><h3 id=方法1使用---porcelain-和文本处理>方法1：使用 <code>--porcelain</code> 和文本处理</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 获取未跟踪文件</span>
</span></span><span style=display:flex><span>git status --porcelain | grep <span style=color:#e6db74>&#39;^??&#39;</span> | cut -c4-
</span></span></code></pre></div><h3 id=方法2使用-git-ls-files推荐>方法2：使用 <code>git ls-files</code>（推荐）</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 直接获取未跟踪文件（更高效）</span>
</span></span><span style=display:flex><span>git ls-files --others --exclude-standard
</span></span></code></pre></div><h3 id=方法3在脚本中使用>方法3：在脚本中使用</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e># 检查是否有未跟踪文件</span>
</span></span><span style=display:flex><span>untracked_files<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>git ls-files --others --exclude-standard<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$untracked_files<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;发现未跟踪文件：&#34;</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;</span>$untracked_files<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;没有未跟踪文件&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h2 id=fish-shell-中的实用函数>Fish Shell 中的实用函数</h2><p>如果你使用 Fish shell，可以创建一个便捷函数：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fish data-lang=fish><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>git</span>-untracked
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>git</span> ls-files <span style=color:#a6e22e>--others</span> <span style=color:#a6e22e>--exclude-standard</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>git</span>-modified
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>git</span> status <span style=color:#a6e22e>--porcelain</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;/^.M/ {print substr($0, 4)}&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>git</span>-staged
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>git</span> status <span style=color:#a6e22e>--porcelain</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>awk</span> <span style=color:#e6db74>&#39;/^[MADRCU]/ {print substr($0, 4)}&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><h2 id=更深入探索-git-的内部机制>更深入：探索 Git 的内部机制</h2><p>如果你对 Git 的内部工作原理感兴趣，这里是一些 plumbing 命令的实际演示：</p><h3 id=手动创建-git-对象>手动创建 Git 对象</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 创建一个文件对象（blob）</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Hello World&#34;</span> | git hash-object -w --stdin
</span></span><span style=display:flex><span><span style=color:#75715e># 输出：557db03de997c86a4a028e1ebd3a1ceb225be238</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看对象内容</span>
</span></span><span style=display:flex><span>git cat-file -p 557db03de997c86a4a028e1ebd3a1ceb225be238
</span></span><span style=display:flex><span><span style=color:#75715e># 输出：Hello World</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看对象类型</span>
</span></span><span style=display:flex><span>git cat-file -t 557db03de997c86a4a028e1ebd3a1ceb225be238
</span></span><span style=display:flex><span><span style=color:#75715e># 输出：blob</span>
</span></span></code></pre></div><h3 id=git-对象的三种类型>Git 对象的三种类型</h3><pre class=mermaid>
  graph TD
    A[&#34;Git 对象&#34;] --&gt; B[&#34;Blob&lt;br/&gt;文件内容&#34;]
    A --&gt; C[&#34;Tree&lt;br/&gt;目录结构&#34;]
    A --&gt; D[&#34;Commit&lt;br/&gt;提交信息&#34;]
    
    B --&gt; B1[&#34;存储文件内容&#34;]
    B --&gt; B2[&#34;不包含文件名&#34;]
    
    C --&gt; C1[&#34;指向 blob 对象&#34;]
    C --&gt; C2[&#34;包含文件名和权限&#34;]
    C --&gt; C3[&#34;可以包含子目录&#34;]
    
    D --&gt; D1[&#34;指向 tree 对象&#34;]
    D --&gt; D2[&#34;包含作者信息&#34;]
    D --&gt; D3[&#34;包含提交消息&#34;]
    D --&gt; D4[&#34;指向父提交&#34;]
    
    style B fill:#e1f5fe
    style C fill:#e8f5e8
    style D fill:#fff3e0
</pre><h2 id=实践建议>实践建议</h2><h3 id=什么时候使用哪种方法>什么时候使用哪种方法？</h3><ol><li><strong>日常使用</strong>：直接用 <code>git status</code>，享受美观的输出</li><li><strong>脚本自动化</strong>：使用 <code>git status --porcelain</code> 或 <code>git ls-files</code></li><li><strong>性能要求高</strong>：优先选择 <code>git ls-files</code> 系列命令</li><li><strong>学习 Git 内部机制</strong>：探索 plumbing 命令</li></ol><h3 id=现代开发中的应用>现代开发中的应用</h3><p>在 CI/CD 管道中，这些技术经常被用于：</p><ul><li>检查代码仓库的状态</li><li>自动化部署前的文件验证</li><li>生成变更报告</li><li>实现自定义的 Git 工作流</li></ul><h2 id=总结>总结</h2><p>Git 的 porcelain 和 plumbing 设计体现了优秀软件的双重关注：既要对用户友好，又要对自动化友好。通过理解这种设计哲学，我们可以：</p><ul><li>在合适的场景使用合适的工具</li><li>编写更可靠的自动化脚本</li><li>更深入地理解 Git 的工作原理</li></ul><p>下次当你需要在脚本中处理 Git 信息时，记住这个简单的原则：<strong>美观的给人看，简洁的给机器用</strong>。</p><hr><p><em>提示：本文中的代码示例都可以在实际环境中运行。建议在一个测试仓库中尝试这些命令，以加深理解。</em></p></section><div class=divider></div><div class="flex flex-col md:flex-row justify-between gap-4 py-4"><div></div><a role=button class="btn btn-outline h-12" href=/2025/08/yq-output-control-complete-guide/ title=yq输出控制完全指南：从YAML到任意格式的数据变换艺术><div class="inline-flex flex-col items-end"><span class="text-base-content/60 text-xs font-normal">下一页</span>
<span class="max-w-48 truncate">yq输出控制完全指南：从YAML到任意格式的数据变换艺术</span></div><ion-icon name=chevron-forward></ion-icon></a></div><div class=divider></div><section class=space-y-4><article><div id=tcomment></div><script src=https://cdn.jsdelivr.net/npm/twikoo@1.6.41/dist/twikoo.min.js></script><script>twikoo.init({envId:"https://6dhzwvtyqz753zhpkrvnnydhlm0vubmy.lambda-url.ap-east-1.on.aws/",el:"#tcomment",region:"ap-east-1",path:"/2025/08/git-status-parsing-porcelain-plumbing/",lang:"zh-CN"})</script></article></section></article></div><div x-data=tocHighlighter() @scroll.window=debouncedScroll class="hidden lg:flex lg:flex-col lg:items-end"><nav id=TableOfContents><ul><li><a href=#问题的起源两种不同的需求>问题的起源：两种不同的需求</a><ul><li><a href=#普通的-git-status-输出>普通的 git status 输出</a></li></ul></li><li><a href=#git-的双重设计哲学porcelain-vs-plumbing>Git 的双重设计哲学：Porcelain vs Plumbing</a><ul><li><a href=#porcelain瓷器命令>Porcelain（瓷器）命令</a></li><li><a href=#plumbing管道命令>Plumbing（管道）命令</a></li></ul></li><li><a href=#解决方案--porcelain-选项>解决方案：<code>--porcelain</code> 选项</a><ul><li><a href=#获取机器友好的状态输出>获取机器友好的状态输出</a></li><li><a href=#状态代码解释>状态代码解释</a></li></ul></li><li><a href=#实际应用提取未跟踪文件列表>实际应用：提取未跟踪文件列表</a><ul><li><a href=#方法1使用---porcelain-和文本处理>方法1：使用 <code>--porcelain</code> 和文本处理</a></li><li><a href=#方法2使用-git-ls-files推荐>方法2：使用 <code>git ls-files</code>（推荐）</a></li><li><a href=#方法3在脚本中使用>方法3：在脚本中使用</a></li></ul></li><li><a href=#fish-shell-中的实用函数>Fish Shell 中的实用函数</a></li><li><a href=#更深入探索-git-的内部机制>更深入：探索 Git 的内部机制</a><ul><li><a href=#手动创建-git-对象>手动创建 Git 对象</a></li><li><a href=#git-对象的三种类型>Git 对象的三种类型</a></li></ul></li><li><a href=#实践建议>实践建议</a><ul><li><a href=#什么时候使用哪种方法>什么时候使用哪种方法？</a></li><li><a href=#现代开发中的应用>现代开发中的应用</a></li></ul></li><li><a href=#总结>总结</a></li></ul></nav></div></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 爱解决</p><p>硅基生物幼稚园</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div><div class=back><div class=container><div class="dream-grid dream-grid-about"></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>© 2025 爱解决</p><p>硅基生物幼稚园</p></div><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><section><span id=busuanzi_container_value_site_pv><i class="far fa-eye fa-fw"></i>
本站总访问量 <span id=busuanzi_value_site_pv></span>
</span>&nbsp;|&nbsp;
<span id=busuanzi_container_value_site_uv><i class="fa fa-user"></i>
本站访客数 <span id=busuanzi_value_site_uv></span></span></section></span></section></script><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div></div></div><script>window.lightTheme="emerald",window.darkTheme="forest"</script><script src=https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin=anonymous></script><script src=/js/grid.min.js></script><script src=/js/main.min.js></script><script src=https://cdn.jsdelivr.net/npm/luxon@1.26.0 integrity="sha256-4sbTzmCCW9LGrIh5OsN8V5Pfdad1F1MwhLAOyXKnsE0=" crossorigin=anonymous></script><script>format();function format(){document.querySelectorAll('span[data-format="luxon"]').forEach(e=>{const t=e.textContent;e.textContent=luxon.DateTime.fromISO(t,{locale:"zh"}).toFormat("yyyy年MM月dd日 HH:mm")})}</script><script src=/js/toc.min.js></script><script type=module>
      import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm';
      mediumZoom('#dream-single-post-content img', {
        background: 'oklch(var(--b1))',
        margin: 24,
      })
    </script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
      </script><script async src="https://www.googletagmanager.com/gtag/js?id=G-S0KCH9BW4F"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S0KCH9BW4F")}</script><script type=module src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin=anonymous></script><script nomodule src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin=anonymous></script></body></html>