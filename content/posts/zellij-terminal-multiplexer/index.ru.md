---
title: "Zellij: Модернизация терминального мультиплексора - руководство по переходу с tmux"
date: 2025-03-30T00:48:19+04:00
slug: "zellij-terminal-multiplexer-guide"
draft: false
cover: "https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250330004913707.webp"
tags:
  - "инструмент разработки"
  - "Терминальные инструменты"
  - "Ржавчина"
  - "Повышение эффективности"
---

Приходилось ли вам открывать множество окон терминала для одновременного выполнения нескольких команд? Или беспокоитесь о потере прогресса каждый раз, когда подключаетесь к серверу по SSH и теряете соединение? Терминальный мультиплексор решает эти проблемы, и Zellij - один из первых, кто начал реализовывать Rust в этой области, предлагая отличный пользовательский опыт и уникальные возможности.

<! --подробнее-->

## Что такое Zellij?

Zellij - это современный терминальный мультиплексор, написанный на Rust, похожий на tmux или screen, но с более современной философией дизайна и пользовательским интерфейсом. Он позволяет запускать несколько терминальных сессий одновременно в одном окне терминала, а также отсоединять и присоединять сессии, не прерывая работу программ.

### Почему Zellij?

Zellij предлагает ряд неоспоримых преимуществ как для опытных пользователей tmux, так и для новичков в области терминальной многозадачности:

1. **Более удобная конфигурация по умолчанию** - из коробки, не нужно ничего настраивать!
2. **Интуитивно понятные привязки клавиш** - легче запомнить и использовать
3. **Плавающие панели** - уникальная возможность создания панелей, накладывающихся на основную рабочую область
4. **Мощная система макетов** - декларативная конфигурация, удобная для определения и повторного использования
5. **Улучшенные возможности копирования и вставки** - включая редактирование буфера прокрутки в редакторе

## Переход с tmux на Zellij

### Установка

На macOS можно установить с помощью Homebrew:

```bash
brew install zellij
```_.

В Linux вы можете использовать менеджер пакетов или установить через Cargo:

```bash
cargo install zellij
```

Более подробную информацию об установке можно найти в [официальной документации](https://zellij.dev/documentation/installation.html).

### Сравнение основных концепций

| концепции tmux | эквивалентные концепции Zellij | описание |
| ---------| ---------------| ------|
Сеанс | Session | Session | Коллекция терминальных окон |
| Окно | Вкладка | Страница с переключаемыми представлениями |
| Pane | Панель | отдельный экземпляр терминала |
| | | Префиксная клавиша (по умолчанию Ctrl+b) | Клавиша переключения режимов (по умолчанию Ctrl+g) | Комбинация клавиш для активации командного режима |

### Ключевые различия и примечания

Самое большое отличие Zellij в том, что в нем используется "система режимов" - аналогично концепции режимов в vim:

- **Нормальный режим**: набранное содержимое отправляется непосредственно в терминальное приложение.
- **Командный режим**: активируется префиксной клавишей и выполняет действия Zellij.
- **Режим прокрутки**: прокрутка истории.
- **Режим поиска**: поиск содержимого терминала.
- И так далее...

## Настройка Zellij для пользователей tmux

Если вы привыкли к tmux, есть некоторые настройки, которые можно сделать, чтобы приблизить нажатие клавиш Zellij к tmux. Ниже приведен пример конфигурации Zellij для пользователей tmux:

```kdl
// ~/.config/zellij/config.kdl
keybinds {
    normal {
        // 移除默认的 Ctrl+g 前缀
        unbind "Ctrl g"
        // 禁用 Ctrl+s 以避免与文本编辑器冲突
        unbind "Ctrl s"
        // 使用 Ctrl+q 作为前缀键（可改为 Ctrl+b 以匹配 tmux）
        bind "Ctrl q" { SwitchToMode "tmux"; }
    }
    
    tmux {
        // 前缀键按两次发送一次前缀键给应用程序
        bind "Ctrl q" { Write 17; SwitchToMode "normal"; }
        
        // 窗口管理（类似 tmux 的 window）
        bind "c" { NewTab; SwitchToMode "normal"; }
        bind "," { SwitchToMode "RenameTab"; }
        
        // 面板分割（类似 tmux 的 split-window）
        bind "\\" { NewPane "Right"; SwitchToMode "normal"; }
        bind "-" { NewPane "Down"; SwitchToMode "normal"; }
        
        // vim 风格的窗格切换
        bind "h" { MoveFocus "Left"; SwitchToMode "normal"; }
        bind "l" { MoveFocus "Right"; SwitchToMode "normal"; }
        bind "j" { MoveFocus "Down"; SwitchToMode "normal"; }
        bind "k" { MoveFocus "Up"; SwitchToMode "normal"; }
        
        // 会话管理
        bind "d" { Detach; }
        
        // 浮动窗格（Zellij 特有功能）
        bind "w" { ToggleFloatingPanes; SwitchToMode "normal"; }
        
        // 进入复制模式
        bind "[" { SwitchToMode "scroll"; }
    }
    
    // 滚动/复制模式
    scroll {
        // vim 风格的导航
        bind "j" { ScrollDown; }
        bind "k" { ScrollUp; }
        bind "d" { HalfPageScrollDown; }
        bind "u" { HalfPageScrollUp; }
        bind "G" { ScrollToBottom; }
        
        // 复制操作
        bind "y" { Copy; }
        
        // 使用编辑器打开缓冲区
        bind "e" { EditScrollback; SwitchToMode "normal"; }
        
        // 退出复制模式
        bind "q" { SwitchToMode "normal"; }
    }
}

options {
    // MacOS系统设置系统剪贴板集成
    copy_command "pbcopy"
    
    // 防止窗格在命令结束时自动关闭
    pane_close_on_exit false
}
```.

## Система раскладки Zellij

Система компоновки Zellij - это одна из главных особенностей Zellij, которая определяет расположение окон с помощью файлов формата KDL:

```kdl
// ~/.config/zellij/layouts/dev.kdl
layout {
    // 默认标签页模板
    default_tab_template {
        // 标签栏
        pane size=1 borderless=true {
            plugin location="zellij:tab-bar"
        }
        // 子窗格内容
        children
        // 状态栏
        pane size=2 borderless=true {
            plugin location="zellij:status-bar"
        }
    }
    
    // 会话名称（可选）
    session_name "dev"
    
    // 系统监控标签页
    tab name="monitor" {
        pane command="htop"
    }
    
    // 编辑标签页
    tab name="editor" {
        pane command="nvim"
    }
    
    // 分割窗格的标签页
    tab name="terminal" {
        pane split_direction="horizontal" {
            pane size="60%"
            pane size="40%" split_direction="vertical" {
                pane
                pane
            }
        }
    }
}
```.

Начните с пользовательского макета:

```bash
zellij --layout dev
```

## Общие сочетания клавиш и функции

Ниже перечислены общие действия при использовании описанной выше конфигурации:

### Управление сеансами

- **Запуск новой сессии**: `zellij`
- **Именование запуска сессии**: `zellij -s 会话名称`
- **Включение сессии в список**:`zellij list-sessions`
- **Присоединение к сессии**:`zellij attach 会话名称`
- **Разделить сессию**: `Ctrl+q d`

### Манипуляции с панелями

- **Создает горизонтально разделенную панель**:`Ctrl+q -`
- **Создает вертикально разделенную панель**:`Ctrl+q \`
- **Переключение фокуса панели**: `Ctrl+q`, затем `h/j/k/l` (стиль vim)
- **Изменение размера панели**: `Ctrl+q`, затем клавиши со стрелками
- **Закрыть текущую панель**:`Ctrl+q x`
- **Полный экран текущей панели**: `Ctrl+q z`

### Управление вкладками

- **Создать новую вкладку**:`Ctrl+q c`
- **Переименовать вкладки**:`Ctrl+q ,`
- **Переключать вкладки**: щелкните мышью в строке состояния или используйте клавиши `Alt+数字`.
- **Перемещение вкладок**: `Ctrl+q Ctrl+j` (вправо) или `Ctrl+q Ctrl+k` (влево)

### Режим копирования

- **Вход в режим прокрутки**: `Ctrl+q [`
- **Начните выделение в режиме прокрутки**: `v`
- **Копирование выделения**:`y`
- **Редактировать буфер прокрутки**: нажмите `e` в режиме прокрутки.
- **Выход из режима прокрутки**: `q` или `Escape`

### Особенности Zellij

- **Плавающая панель**: `Ctrl+q w` Переключение видимости плавающей панели
- **Выполнение команд на плавающих панелях**:`zellij run --floating -- 命令`
- **Блокировка режимов**: `Ctrl+q Ctrl+g`
- **Режим команд**:`Ctrl+q :` Затем введите команду

## Практические примеры: разработка рабочих процессов

Используйте Zellij для создания эффективного рабочего процесса разработки со следующими компонентами:

1. **мониторинг системы**: htop на отдельной вкладке
2. **Редактирование кода**: nvim на основной вкладке
3. **Сборка и тестирование**: разделенная панель для запуска тестов и просмотра результатов
4. **Мониторинг логов**: плавающая панель для просмотра логов в реальном времени

```kdl
// ~/.config/zellij/layouts/dev.kdl
layout {
    default_tab_template {
        pane size=1 borderless=true {
            plugin location="zellij:tab-bar"
        }
        children
        pane size=2 borderless=true {
            plugin location="zellij:status-bar"
        }
    }
    
    session_name "dev"
    
    tab name="monitor" {
        pane command="htop"
    }
    
    tab name="code" {
        pane command="nvim" cwd="/path/to/project"
    }
    
    tab name="build" {
        pane split_direction="horizontal" {
            pane command="sh" {
                args "-c" "echo 'Ready to build'; $SHELL"
            }
            pane command="sh" {
                args "-c" "echo 'Ready to test'; $SHELL"
            }
        }
    }
    
    // 浮动日志窗格
    floating_panes {
        pane command="tail" {
            args "-f" "/path/to/log/file.log"
        }
    }
}
```.

## Советы и ловушки

### Обработка переменных окружения в файлах компоновки

Переменные окружения в файлах макетов Zellij не расширяются автоматически. Лучше всего использовать команду `sh -c`:

```kdl
pane command="sh" {
    args "-c" "tail -f $HOME/logs/app.log"
}
```

### Предотвращение неожиданного закрытия панелей

Установите глобальную опцию или установите ее для определенной панели:

```kdl
// 全局设置
options {
    pane_close_on_exit false
}

// 或针对特定窗格
pane close_on_exit=false {
    // ...
}
```.

### Копирование и вставка лучших практик

Для сложных операций копирования используйте режим редактора:

1. Войдите в режим прокрутки: `Ctrl+q [`.
2. Нажмите `e`, чтобы открыть содержимое в редакторе по умолчанию.
3. Используйте все возможности редактора (поиск, копирование и т. д.).
4. Сохраните и выйдите обратно в Zellij

## Заключение

Zellij предлагает современный опыт и инновационные функции для терминального мультиплексирования. Он обеспечивает плавный переход для опытных пользователей tmux и снижает барьер для новых пользователей. С помощью настроек и руководств, приведенных в этой статье, вы сможете легко начать использовать Zellij для повышения производительности терминалов.

Zellij все еще находится в стадии активной разработки, и в него постоянно добавляются новые функции. Рекомендуется регулярно проверять [официальную документацию](https://zellij.dev/documentation/) для получения последней информации.

Как вы организуете свои сквозные рабочие процессы и какие функции Zellij наиболее полезны для вас? Не стесняйтесь делиться своим опытом в комментариях.
