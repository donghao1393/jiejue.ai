---
title: "Git 分支搬家神器：5分钟学会 rebase --onto"
date: 2025-09-05T15:13:13+04:00
slug: 'git-rebase-onto-quick-guide'
draft: false
cover: "https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250905151737174.webp"
tags:
  - Git
  - 分支管理
  - 快速教程
---

你是不是遇到过这种情况：辛苦写了几个代码提交，后来发现放错分支了？别担心，Git 有个"搬家"命令能帮你轻松解决！

<!--more-->

## 什么时候需要"搬家"？

想象一下，小张在一家销售公司做技术支持，他在分支A上做了 3 个重要的工作。突然老板说："这些工作要基于分支B，分支A太复杂了！"

以前小张可能会：
1. 手动复制所有文件
2. 一个个重新提交
3. 祈祷不要出错

现在有了 `git rebase --onto`，一行命令就搞定！

## 超简单 3 步法

### 第 1 步：搞清楚你要搬什么
```bash
# 看看你的分支现在什么样
git log --oneline -5
```

假设你看到：
```
abc123 第3个工作提交
def456 第2个工作提交  
ghi789 第1个工作提交
jkl012 分支A的其他内容
...
```

### 第 2 步：一键搬家
```bash
git rebase --onto 目标分支 原来的基础分支
```

具体例子：
```bash
git rebase --onto branch_B branch_A
```

这句话的意思是："把我这个分支从 branch_A 分支上搬到 branch_B 分支上"

### 第 3 步：检查搬家结果
```bash
git log --oneline -5
```

现在你应该看到你的 3 个工作提交已经"搬"到新分支上了！

## 真实案例：小张的工作调整

**搬家前：**
```
分支A ← 小张的工作分支
  ↑
包含很多小张不懂的新内容
```

**搬家后：**
```
分支B ← 小张的工作分支  
  ↑
稳定的代码，小张很放心
```

**具体操作：**
```bash
# 小张在他的工作分支上
git checkout my_work

# 一键搬家！
git rebase --onto branch_B branch_A

# 搞定！检查一下
git log --oneline -3
```

## 为什么这样做比复制粘贴好？

1. **保持历史记录**：你的提交记录还在，包括时间、作者、注释
2. **一次性完成**：不用一个个文件复制
3. **自动处理冲突**：如果有冲突，Git 会提示你处理
4. **可以撤销**：如果搞错了，还能撤回

## 常见问题速答

**Q：如果搬家过程中出现冲突怎么办？**
A：Git 会停下来让你处理，解决冲突后输入：
```bash
git add .
git rebase --continue
```

**Q：如果我后悔了想撤销怎么办？**
A：输入这个"后悔药"：
```bash
git rebase --abort
```

**Q：我怎么知道搬家成功了？**
A：看两个地方：
- `git log` 显示你的提交现在基于新分支
- `git status` 显示 "nothing to commit, working tree clean"

## 小贴士

1. **搬家前先备份**：
   ```bash
   git checkout -b 我的备份分支
   git checkout 原分支
   ```

2. **确保分支是最新的**：
   ```bash
   git fetch origin
   ```

3. **一次只搬一个分支**，别贪多

## 什么时候用这个命令？

- ✅ 你的几个提交应该基于另一个分支
- ✅ 你想要保持提交历史的完整性  
- ✅ 你的提交是连续的几个

- ❌ 只想要其中某一个提交（用 cherry-pick）
- ❌ 分支已经分享给其他人了（会搞乱别人的工作）

## 总结

`git rebase --onto` 就像是给你的代码"搬家"：
- 把你的提交从一个分支搬到另一个分支
- 保持所有的历史记录
- 一行命令搞定

记住这个万能公式：
```bash
git rebase --onto 要搬到哪里 从哪里搬
```

下次遇到分支搞错的情况，别慌张，用这个命令轻松搞定！

