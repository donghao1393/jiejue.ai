---
title: "Устранение проблем совместимости версий при подключении MongoDB Compass к Azure Cosmos DB"
date: 2025-02-25T00:15:48+04:00
slug: "mongodb-compass-azure-cosmos-compatibility"
draft: false
cover: "https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250225001857779.webp"
tags:
  - "MongoDB"
  - "Лазурь"
  - "всеобъемлющая база данных"
  - "Устранение проблем"
---

Сталкивались ли вы с проблемами совместимости версий при подключении к Azure Cosmos DB с помощью MongoDB Compass? Очевидно, что вы следовали руководству шаг за шагом, но так и не смогли успешно подключиться? В этой статье мы раскроем причину и предложим вам простое и эффективное решение.

<! --подробнее-->

## Феномен проблемы

Чжан - аналитик данных в компании, занимающейся электронной коммерцией, и ему необходимо просмотреть базу данных MongoDB компании, развернутую в Azure Cosmos DB. Следуя указаниям в документации компании, он устанавливает последнюю версию MongoDB Compass, заполняет строку подключения, но получает следующую ошибку:

```
MongoServerSelectionError: Server at enterprise-data-warehouse.mongo.cosmos.azure.com:10255 reports maximum wire version 6, but this version of the Node.js Driver requires at least 7 (MongoDB 4.0)
```.

Эта ошибка приводит Чжана в замешательство. Строка подключения верна, так почему же она указывает на несовместимость версий?

## Анализ проблемы

Это сообщение об ошибке фактически говорит нам, в чем проблема:

1. версия API MongoDB для Azure Cosmos DB соответствует версии 6 wire (что соответствует MongoDB 3.6)
2. последняя версия MongoDB Compass использует внутри себя более новый драйвер Node.js (6.10.0 или более позднюю версию), который требует как минимум версии 7 (MongoDB 4.0).

Короче говоря, **новая версия MongoDB Compass больше не поддерживает соединения со старыми серверами MongoDB**.

Это изменение было внесено в версию 6.10.0 драйвера MongoDB Node.js, как описано на официальных форумах MongoDB:

> "Начиная с Node.js Driver 6.10.0 минимальная версия MongoDB, необходимая для работы, составляет 4.0".

## Решение

Есть два решения этой проблемы:

### Вариант 1: Понизить версию MongoDB Compass (рекомендуется).

Самое простое решение - установить более старую версию MongoDB Compass следующим образом:

1. Удалите текущую версию MongoDB Compass.
2. Посетите страницу релиза MongoDB Compass [GitHub](__PROTECTED_LINK_URL__2__).
3. Загрузите версию 1.36.2 программы установки (это последняя версия, проверенная для подключения к MongoDB 3.6).
4. Установите загруженный MongoDB Compass версии 1.36.2.
5. Повторите подключение, используя ту же строку подключения

```mermaid
flowchart TD
    A[发现连接错误] --> B[确认错误为版本兼容性问题]
    B --> C[卸载当前版本 MongoDB Compass]
    C --> D[从 GitHub 下载 1.36.2 版本]
    D --> E[安装 1.36.2 版本]
    E --> F[使用相同连接字符串连接]
    F --> G[连接成功]
```.

### Вариант 2: Обновление версии API MongoDB для Azure Cosmos DB

Если у вас есть доступ к изменению конфигурации Azure Cosmos DB, вы также можете рассмотреть возможность обновления версии API MongoDB до 4.0 или выше:

1. войдите на портал Azure
2. найдите свою учетную запись Cosmos DB
3. найдите и обновите версию MongoDB API до 4.0 или выше в разделе "Настройки

⚠️ **ПРЕДУПРЕЖДЕНИЕ**: Обновление версии базы данных может повлиять на совместимость существующих приложений, поэтому рекомендуется соблюдать осторожность в производственных средах и лучше сначала проверить в тестовой среде.

## Почему возникает эта проблема?

MongoDB, будучи популярной базой данных, время от времени обновляет свой протокол и функции. Начиная с версии MongoDB 4.0, были внесены некоторые важные изменения, включая улучшения в поддержке транзакций и механизмах аутентификации. Чтобы поддерживать эти новые возможности, драйвер должен быть обновлен соответствующим образом.

К сожалению, это привело к ситуациям, когда новые версии драйвера несовместимы со старыми версиями сервера. Для облачных сервисов, таких как Azure Cosmos DB, пользователи часто не могут легко обновить свою версию, поэтому понижение версии клиентского инструмента является более практичным решением.

## Резюме

При использовании MongoDB Compass для подключения к Azure Cosmos DB, если вы столкнулись с проблемами совместимости версий, самым простым решением будет понижение версии MongoDB Compass до версии 1.36.2. Эта проблема показывает нам, что совместимость версий также важна при работе с базами данных, и что иногда "новейшая" версия не означает "лучшая".

Надеемся, это решение поможет вам, если вы столкнулись с подобной проблемой. Если у вас есть другие проблемы, связанные с MongoDB, пожалуйста, оставляйте комментарии в разделе комментариев!
