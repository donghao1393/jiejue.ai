---
title: "Магия извлечения данных: 5 минут, чтобы научиться использовать командную строку для обработки сложных журналов"
date: Sat Jul 26 2025 11:32:34 GMT+0000 (Coordinated Universal Time)
slug: "ripgrep-data-extraction-quick-guide"
draft: false
cover: "https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250726153651688.webp"
tags:
  - "Командная строка (вычислительная техника)"
  - "обработка данных"
  - "эффективность работы"
  - "ripgrep"
---

Приходилось ли вам сталкиваться со сценарием, когда начальник просит вас найти конкретные данные из тысяч строк журналов инвентаризации, например количество товаров на складе и модели продуктов, а затем свести их в таблицу? Ручное копирование и вставка не только неэффективны, но и чреваты ошибками. Сегодня я расскажу вам о суперполезном трюке командной строки, позволяющем выполнить подобную задачу извлечения данных за несколько минут.

<!--more-->

## 真实场景：仓管小李的烦恼

Менеджер склада Ли недавно получил задание: извлечь из журналов системы инвентаризации данные о количестве товара на складе и моделях всех продаваемых товаров и свести их в отчет. Файл журнала выглядит следующим образом:

```
商品ID: SKU001  状态: available  库存信息: {'stock': 1500, 'productType': 'laptop-pro'}
商品ID: SKU002  状态: discontinued  库存信息: {'stock': 250, 'productType': 'tablet-mini'}
...
```

Если использовать традиционный метод, Ли необходимо:
1. открыть файл в текстовом редакторе
2. вручную найти строки, содержащие слово "в наличии".
3. скопировать информацию об инвентаре и товарах построчно
4. вставить ее в таблицу

Это не только утомительно, но и легко пропустить или допустить ошибку.

## 解决方案：三步搞定数据提取

### 第一步：找到目标数据

Используйте ripgrep (инструмент быстрого поиска), чтобы отфильтровать строки, содержащие слово "available", из файла:

```bash
cat 库存日志.txt | rg available
```

На этом шаге отображается список всех товаров, выставленных на продажу.

### 第二步：精确提取需要的信息

Затем извлеките номера складов и модели продуктов:

```bash
cat 库存日志.txt | rg available | rg -o "'stock': \d+,|'productType': '[\w-]*?'"
```

Эта команда действует как "умное сито":
- `rg -o` означает "показывать только совпадения".
- `'stock': \d+,` соответствует информации о складе (числовая часть).
- `|` означает "или".
- `'productType'': '[\w-]*? `Соответствует типу товара

现在你会看到类似这样的输出：
```
'stock': 1500,
'productType': 'laptop-pro'
'stock': 250,
'productType': 'tablet-mini'
```

### 第三步：整理成表格格式

Используйте команду paste, чтобы поместить парные сообщения в одну строку:

```bash
cat 库存日志.txt | rg available | rg -o "'stock': \d+,|'productType': '[\w-]*?'" | paste - -
```

输出变成：
```
'stock': 1500,     'productType': 'laptop-pro'
'stock': 250,      'productType': 'tablet-mini'
```

## 遇到数据不整齐怎么办？

Иногда данные журнала бывают неполными, например, в некоторых записях отсутствует информация об инвентаризации. В этом случае вывод может быть ошибочным:

```
'productType': 'laptop-pro'     'stock': 1500,
'productType': 'monitor-4k'     'stock': 250,
```

**Решение**: добавьте идентификатор продукта в извлечение, чтобы сформировать три колонки данных:

```bash
cat 库存日志.txt | rg available | rg -o " ([A-Z]{3}\d{3}) |'stock': \d+,|'productType': '.*?'" | paste -d "," - - - | column -t -s ","
```

Таким образом, даже если какое-то поле отсутствует, соответствие данных можно поддерживать по идентификатору продукта.

## 实用技巧总结

1. **Запомните эту универсальную формулу**: `источник данных | критерии фильтрации rg | rg -o правило извлечения | вставить форматирование`.

2. **Общие правила извлечения**:
   - Извлечение чисел: \\\d+`
   - Извлечение слов: `\w+`.
   - Извлечение содержимого инвертированных запятых: `'. *?' `

3. **Варианты форматирования**:
   - `paste - -` два столбца рядом
   - `paste -d "," -` Разделять запятыми
   - `column -t` Выравнивание колонок.

## 为什么这个方法这么有效？

В основе этого подхода лежит "конвейерное мышление": разбиение сложных задач на простые этапы, где каждый инструмент выполняет только одну задачу, но их сочетание дает мощный эффект. Это похоже на заводской конвейер, с четким разделением труда на каждом этапе, что приводит к высококачественным результатам.

Работаете ли вы с инвентарными журналами, анализируете данные о продажах или собираете заказы клиентов - вы сможете быстро извлечь нужную информацию и значительно повысить свою производительность!

В следующий раз, когда вы столкнетесь с подобной задачей извлечения данных, не забудьте попробовать этот метод. Вы увидите, что работа, на которую раньше уходили часы, теперь может быть выполнена за считанные минуты.