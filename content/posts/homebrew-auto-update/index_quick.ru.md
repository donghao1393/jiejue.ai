---
title: "Essential for Mac Users: Homebrew Automatic Updates Configuration Guide"
date: 2025-05-03T11:09:08+04:00
slug: "homebrew-auto-update-guide"
draft: false
cover: "https://jiejue.obs.ap-southeast-1.myhuaweicloud.com/20250503111511793.webp"
tags:
  - "Мак"
  - "Домашний"
  - "автоматический"
  - "Инструменты эффективности"
---

# Mac 用户必备：Homebrew 自动更新配置指南

У вас когда-нибудь возникали проблемы с программным обеспечением из-за того, что вы забыли обновить пакеты Homebrew? Или вам надоело каждый раз вручную выполнять команду update? В этой статье мы расскажем вам о простом способе, который позволит вашему Mac автоматически обновлять пакеты Homebrew в ранние утренние часы каждый день, пока вы спокойно спите!

<!--more-->

## 为什么需要自动更新 Homebrew？

Минг - дизайнер, который каждый день использует различные инструменты для дизайна на своем Mac. Однажды он обнаружил, что одна из часто используемых им программ для дизайна внезапно перестала работать должным образом. После некоторого поиска неисправностей выяснилось, что одна из библиотек, на которые опирается программа, слишком устарела. Если бы он регулярно обновлял пакет Homebrew, то не столкнулся бы с этой проблемой.

Однако выполнять команды `brew update` и `brew upgrade` вручную слишком хлопотно и легко забыть. Есть ли способ заставить компьютер делать это автоматически?

## 解决方案：homebrew-autoupdate

Хорошая новость заключается в том, что существует инструмент `homebrew-autoupdate`, который может помочь нам с автоматическими обновлениями. Что еще лучше, недавно была добавлена опция `--leaves-only` для обновления только тех пакетов, которые мы устанавливаем напрямую, а не тех, которые установлены в качестве зависимостей, что значительно уменьшает проблемы совместимости, вызванные обновлениями зависимостей.

## 如何设置自动更新

### 步骤 1：安装 homebrew-autoupdate

Откройте терминал и введите следующую команду:

```bash
brew tap domt4/autoupdate
```

### 步骤 2：配置自动更新

Далее нам нужно настроить автоматическое обновление. Предполагая, что мы хотим автоматически обновлять каждый день в 4.25 утра и только пакеты верхнего уровня (то есть пакеты, которые устанавливаются напрямую, без учета зависимостей), мы можем использовать следующую команду:

```bash
brew autoupdate start 86400 --upgrade --leaves-only --cleanup
```

Смысл этой команды заключается в следующем:
- `start`: запуск автоматического обновления
- `-86400`: обновление через 86400 секунд, т.е. через 24 часа
- `--upgrade`: обновлять не только сам Homebrew, но и установленные пакеты
- `--leaves-only`: обновлять только пакеты верхнего уровня, но не зависимости
- `--cleanup`: автоматическая очистка старых версий и кэшированных файлов.

### 步骤 3：确认设置成功

Чтобы убедиться в том, что автоматические обновления были успешно настроены, можно воспользоваться следующей командой:

```bash
brew autoupdate status
```

Если вы увидите сообщение типа "Autoupdate is currently running..." это означает, что настройка прошла успешно.

## 如何调整更新时间

По умолчанию homebrew-autoupdate будет запускаться один раз сразу после запуска и затем каждые заданные промежутки времени (например, 24 часа). Но это, вероятно, не то, что нам нужно.

Если вы хотите, чтобы он запускался в определенное время (например, в 4.25 утра), вы можете остановить текущее автоматическое обновление, а затем настроить его вручную с помощью системы launchd на Mac.

### 步骤 1：停止当前的自动更新

```bash
brew autoupdate delete
```

### 步骤 2：编辑 plist 文件

Сначала запустите автоматическое обновление, но не запускайте его сразу:

```bash
brew autoupdate start 86400 --upgrade --leaves-only --cleanup
```

Затем отредактируйте файл plist:

```bash
open -e ~/Library/LaunchAgents/com.github.domt4.homebrew-autoupdate.plist
```

В открывшемся файле найдите строки `<key>StartInterval</key>` и `<integer>86400</integer>` и замените их на:

```xml
<key>StartCalendarInterval</key>
<dict>
    <key>Hour</key>
    <integer>4</integer>
    <key>Minute</key>
    <integer>25</integer>
</dict>
```

Сохраните файл и закройте его.

### 步骤 3：重新加载 plist 文件

```bash
launchctl unload ~/Library/LaunchAgents/com.github.domt4.homebrew-autoupdate.plist
launchctl load ~/Library/LaunchAgents/com.github.domt4.homebrew-autoupdate.plist
```

Автоматические обновления теперь будут запускаться в 4.25 утра каждый день, а не каждые 24 часа.

## 查看更新日志

Если вы хотите просмотреть журнал автоматических обновлений, вы можете найти его в следующем месте:

```bash
~/Library/Logs/com.github.domt4.homebrew-autoupdate/
```

## 总结

Утилита homebrew-autoupdate позволяет автоматически обновлять пакеты Homebrew, избавляя вас от необходимости выполнять команды вручную. В частности, с помощью новой опции `--leaves-only` можно обновлять только пакеты верхнего уровня, что значительно снижает проблемы совместимости, вызванные обновлением зависимостей.

После его установки ваш Mac будет автоматически обновлять пакеты Homebrew каждый день в 4:25 утра, поддерживая актуальность вашего программного обеспечения и уменьшая проблемы, связанные с версионированием.

Есть ли у вас другие инструменты автоматизации для повышения производительности? Не стесняйтесь делиться своим опытом в разделе комментариев!